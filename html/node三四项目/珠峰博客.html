<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>珠峰JS全栈</title>
        
    <link rel="stylesheet" type="text/css" href="../../static/css/main.css">
</head>
<body>
<div class="navbar navbar-line">
    <div class="container">
        <div class="logos"></div>
        <div class="logo">

            
                珠峰JS全栈
            
        </div>
        <input type="checkbox" id="idoc_nav" />
        <div class="menu_tree">
        <ul><li><a href="../../index.html">index</a></li><li><a href="#"><span></span>前端工程化</a><ul><li><a href="../../html/前端工程化/gulp.html">gulp</a></li><li><a href="../../html/前端工程化/webpack.html">webpack</a></li></ul></li><li><a href="#"><span></span>数据库</a><ul><li><a href="../../html/数据库/mongoose.html">mongoose</a></li><li><a href="../../html/数据库/mysql.html">mysql</a></li><li><a href="../../html/数据库/mongodb.html">mongodb</a></li></ul></li><li><a href="#"><span></span>CSS</a><ul><li><a href="../../html/CSS/less.html">less</a></li><li><a href="../../html/CSS/jade.html">jade</a></li><li><a href="../../html/CSS/CSS布局模型.html">CSS布局模型</a></li><li><a href="#"><span></span>基础</a><ul><li><a href="../../html/CSS/基础/CSS布局模型.html">CSS布局模型</a></li><li><a href="../../html/CSS/基础/盒子模型.html">盒子模型</a></li></ul></li><li><a href="#"><span></span>深入学习</a><ul><li><a href="../../html/CSS/深入学习/margin.html">margin</a></li></ul></li></ul></li><li><a href="#"><span></span>Git</a><ul><li><a href="../../html/Git/git入门.html">git入门</a></li></ul></li><li><a href="#"><span></span>工具</a><ul><li><a href="../../html/工具/和谐.html">和谐</a></li><li><a href="../../html/工具/webstorm安装与配置.html">webstorm安装与配置</a></li><li><a href="../../html/工具/bower.html">bower</a></li><li><a href="../../html/工具/babel.html">babel</a></li></ul></li><li><a href="#"><span></span>微信</a><ul><li><a href="../../html/微信/微信开发.html">微信开发</a></li><li><a href="../../html/微信/OAuth实现.html">OAuth实现</a></li><li><a href="../../html/微信/OAuth理论.html">OAuth理论</a></li></ul></li><li><a href="#"><span></span>面试</a><ul><li><a href="../../html/面试/CSS.html">CSS</a></li><li><a href="../../html/面试/JAVASCRIPT.html">JAVASCRIPT</a></li><li><a href="../../html/面试/其它.html">其它</a></li><li><a href="../../html/面试/性能优化.html">性能优化</a></li><li><a href="../../html/面试/angular.html">angular</a></li><li><a href="../../html/面试/html.html">html</a></li><li><a href="../../html/面试/网络.html">网络</a></li></ul></li><li><a href="#"><span></span>服务器</a><ul><li><a href="../../html/服务器/ubuntu配置PHP.html">ubuntu配置PHP</a></li><li><a href="../../html/服务器/linux基础.html">linux基础</a></li><li><a href="../../html/服务器/linux布署.html">linux布署</a></li><li><a href="../../html/服务器/ftp服务器.html">ftp服务器</a></li><li><a href="../../html/服务器/linux用户管理.html">linux用户管理</a></li></ul></li><li><a href="#"><span></span>AngularJS</a><ul><li><a href="../../html/AngularJS/angular入门.html">angular入门</a></li><li><a href="../../html/AngularJS/angular基础.html">angular基础</a></li><li><a href="../../html/AngularJS/route.html">route</a></li><li><a href="../../html/AngularJS/指令.html">指令</a></li><li><a href="../../html/AngularJS/服务.html">服务</a></li></ul></li><li><a href="#"><span></span>node基础</a><ul><li><a href="../../html/node基础/buffer.html">buffer</a></li><li><a href="../../html/node基础/文件上传.html">文件上传</a></li><li><a href="../../html/node基础/文件操作.html">文件操作</a></li><li><a href="../../html/node基础/模块.html">模块</a></li><li><a href="../../html/node基础/流.html">流</a></li><li><a href="../../html/node基础/node安装与配置.html">node安装与配置</a></li><li><a href="../../html/node基础/NPM.html">NPM</a></li></ul></li><li><a href="#"><span></span>node进阶</a><ul><li><a href="../../html/node进阶/cookie.html">cookie</a></li><li><a href="../../html/node进阶/Express.html">Express</a></li><li><a href="../../html/node进阶/session.html">session</a></li><li><a href="../../html/node进阶/socketio.html">socketio</a></li><li><a href="../../html/node进阶/websocket.html">websocket</a></li><li><a href="../../html/node进阶/加密.html">加密</a></li><li><a href="../../html/node进阶/动态服务器.html">动态服务器</a></li><li><a href="../../html/node进阶/压缩.html">压缩</a></li><li><a href="../../html/node进阶/静态文件服务器.html">静态文件服务器</a></li><li><a href="../../html/node进阶/流高级.html">流高级</a></li></ul></li><li><a href="../../html/首页.html">首页</a></li><li><a href="#"><span></span>react</a><ul><li><a href="../../html/react/react-router.html">react-router</a></li><li><a href="../../html/react/ReactNativeMac.html">ReactNativeMac</a></li><li><a href="../../html/react/ReactNativeWin.html">ReactNativeWin</a></li><li><a href="../../html/react/react基础应用.html">react基础应用</a></li><li><a href="../../html/react/react入门.html">react入门</a></li><li><a href="../../html/react/redux.html">redux</a></li></ul></li><li><a href="#"><span></span>vue</a><ul><li><a href="../../html/vue/Vue入门.html">Vue入门</a></li><li><a href="../../html/vue/Vue方法篇.html">Vue方法篇</a></li><li><a href="../../html/vue/Vue方法篇2.html">Vue方法篇2</a></li><li><a href="../../html/vue/Vue组件.html">Vue组件</a></li></ul></li><li><a href="#"><span></span>JAVASCRIPT</a><ul><li><a href="../../html/JAVASCRIPT/ES6.html">ES6</a></li><li><a href="../../html/JAVASCRIPT/jquery同步和异步.html">jquery同步和异步</a></li><li><a href="../../html/JAVASCRIPT/js常用方法.html">js常用方法</a></li><li><a href="../../html/JAVASCRIPT/promise.html">promise</a></li><li><a href="../../html/JAVASCRIPT/webstorage.html">webstorage</a></li><li><a href="../../html/JAVASCRIPT/初识JS.html">初识JS</a></li><li><a href="../../html/JAVASCRIPT/原型链.html">原型链</a></li><li><a href="../../html/JAVASCRIPT/字符编码.html">字符编码</a></li><li><a href="../../html/JAVASCRIPT/属性设置.html">属性设置</a></li><li><a href="../../html/JAVASCRIPT/模块化开发.html">模块化开发</a></li><li><a href="../../html/JAVASCRIPT/正则表达式.html">正则表达式</a></li><li><a href="../../html/JAVASCRIPT/缓存.html">缓存</a></li><li><a href="../../html/JAVASCRIPT/预解析作用域闭包this.html">预解析作用域闭包this</a></li><li><a href="../../html/JAVASCRIPT/DOM深入.html">DOM深入</a></li><li><a href="../../html/JAVASCRIPT/JS盒子模型.html">JS盒子模型</a></li></ul></li><li><a href="#"><span></span>笔记</a><ul></ul></li><li><a href="#"><span></span>页面效果</a><ul><li><a href="../../html/页面效果/次屏图片延迟加载.html">次屏图片延迟加载</a></li><li><a href="../../html/页面效果/首屏图片延时加载.html">首屏图片延时加载</a></li></ul></li><li><a href="#"><span></span>node大纲</a><ul><li><a href="../../html/node大纲/1.es6.html">1.es6</a></li><li><a href="../../html/node大纲/2.promise.html">2.promise</a></li><li><a href="../../html/node大纲/3.babel.html">3.babel</a></li><li><a href="../../html/node大纲/4.gulp.html">4.gulp</a></li><li><a href="../../html/node大纲/5.webpack.html">5.webpack</a></li><li><a href="../../html/node大纲/6.react入门.html">6.react入门</a></li><li><a href="../../html/node大纲/7.react基础应用.html">7.react基础应用</a></li><li><a href="../../html/node大纲/内网使用.html">内网使用</a></li><li><a href="../../html/node大纲/珠峰服务器布署.html">珠峰服务器布署</a></li></ul></li><li><a href="#"><span></span>node三四项目</a><ul><li class="active"><a href="../../html/node三四项目/珠峰博客.html">珠峰博客</a></li><li><a href="../../html/node三四项目/珠峰爬虫.html">珠峰爬虫</a></li><li><a href="../../html/node三四项目/珠峰聊天室.html">珠峰聊天室</a></li></ul></li><li><a href="#"><span></span>node周末大纲</a><ul><li><a href="../../html/node周末大纲/1.Express.html">1.Express</a></li><li><a href="../../html/node周末大纲/2.cookie.html">2.cookie</a></li><li><a href="../../html/node周末大纲/3.session.html">3.session</a></li><li><a href="../../html/node周末大纲/4.mongodb.html">4.mongodb</a></li><li><a href="../../html/node周末大纲/5.mongoose.html">5.mongoose</a></li><li><a href="../../html/node周末大纲/6.珠峰博客.html">6.珠峰博客</a></li><li><a href="../../html/node周末大纲/7.websocket.html">7.websocket</a></li><li><a href="../../html/node周末大纲/8.socketio.html">8.socketio</a></li></ul></li></ul>
        </div>

        

        <section class="idoc_nav_btn">
            <label for="idoc_nav"><span></span></label>
        </section>
    </div>

</div>





<div class="container">
    
        <div class="page-toc">
            <ul><li><a href="#t01. express生成器生成生成项目">1. express生成器生成生成项目</a><ul><li><a href="#t11.1 安装 Express生成器">1.1 安装 Express生成器</a></li><li><a href="#t21.2 生成一个项目">1.2 生成一个项目</a></li><li><a href="#t31.3 debug">1.3 debug</a></li></ul></li><li><a href="#t42. 项目文件分析">2. 项目文件分析</a><ul><li><a href="#t52.1 生成文件说明">2.1 生成文件说明</a></li><li><a href="#t62.2 app.js">2.2 app.js</a></li><li><a href="#t72.3 bin/www">2.3 bin/www</a></li><li><a href="#t82.4 routes/index.js">2.4 routes/index.js</a></li><li><a href="#t92.5 views/index.ejs">2.5 views/index.ejs</a></li></ul></li><li><a href="#t103. 功能与设计">3. 功能与设计</a><ul><li><a href="#t113.1 功能分析">3.1 功能分析</a></li><li><a href="#t123.2 设计目标">3.2 设计目标</a></li><li><a href="#t133.3 未登录">3.3 未登录</a></li><li><a href="#t143.4 登陆后">3.4 登陆后</a></li><li><a href="#t153.4 发表文章">3.4 发表文章</a></li></ul></li><li><a href="#t164. 配置路由">4. 配置路由</a><ul><li><a href="#t174.1 路由规划">4.1 路由规划</a></li><li><a href="#t184.2 增加路由">4.2 增加路由</a></li><li><a href="#t194.3 修改app.js">4.3 修改app.js</a></li><li><a href="#t204.4 增加模板">4.4 增加模板</a><ul><li><a href="#t214.4.1 views/article/add.ejs">4.4.1 views/article/add.ejs</a></li><li><a href="#t224.4.2 views/user/login.ejs">4.4.2 views/user/login.ejs</a></li><li><a href="#t234.4.3 views/user/reg.ejs">4.4.3 views/user/reg.ejs</a></li></ul></li><li><a href="#t244.5 显示效果">4.5 显示效果</a><ul><li><a href="#t254.5.1 用户注册">4.5.1 用户注册</a></li><li><a href="#t264.5.2 用户登陆">4.5.2 用户登陆</a></li><li><a href="#t274.5.3 发表文章">4.5.3 发表文章</a></li></ul></li></ul></li><li><a href="#t285. 初始化bower">5. 初始化bower</a><ul><li><a href="#t295.1 安装bower">5.1 安装bower</a></li><li><a href="#t305.2 初始化bower">5.2 初始化bower</a></li><li><a href="#t315.3  创建配置文件 .bowerrc">5.3  创建配置文件 .bowerrc</a></li><li><a href="#t325.4 安装bootstrap">5.4 安装bootstrap</a></li></ul></li><li><a href="#t336. 完善页面">6. 完善页面</a><ul><li><a href="#t346.1 创建include文件夹">6.1 创建include文件夹</a></li><li><a href="#t356.2 创建 header.ejs">6.2 创建 header.ejs</a></li><li><a href="#t366.3 创建 footer.ejs">6.3 创建 footer.ejs</a></li><li><a href="#t376.4 修改首页">6.4 修改首页</a></li><li><a href="#t386.5 修改用户注册页面">6.5 修改用户注册页面</a></li><li><a href="#t396.6 修改用户登录界面">6.6 修改用户登录界面</a></li><li><a href="#t406.7 修改发表文章页面">6.7 修改发表文章页面</a></li></ul></li><li><a href="#t417.  连接数据库">7.  连接数据库</a><ul><li><a href="#t427.1 安装数据库支持">7.1 安装数据库支持</a></li><li><a href="#t437.2 创建配置文件">7.2 创建配置文件</a></li><li><a href="#t447.3 创建db文件夹">7.3 创建db文件夹</a></li><li><a href="#t457.4 在app.js中引入此模块">7.4 在app.js中引入此模块</a></li></ul></li><li><a href="#t468. 会话支持">8. 会话支持</a><ul><li><a href="#t478.1 安装会话支持模块">8.1 安装会话支持模块</a></li><li><a href="#t488.2 修改app.js">8.2 修改app.js</a></li></ul></li><li><a href="#t499. 用户注册登陆">9. 用户注册登陆</a><ul><li><a href="#t509.1 增加工具方法">9.1 增加工具方法</a></li><li><a href="#t519.2 用户注册路由">9.2 用户注册路由</a></li><li><a href="#t529.3 用户登陆路由">9.3 用户登陆路由</a></li><li><a href="#t539.4 用户退出路由">9.4 用户退出路由</a></li></ul></li><li><a href="#t5410. 发表文章路由">10. 发表文章路由</a></li><li><a href="#t5511. 页面消息通知">11. 页面消息通知</a><ul><li><a href="#t5611.1 什么是 flash?">11.1 什么是 flash?</a></li><li><a href="#t5711.2  安装模块">11.2  安装模块</a></li><li><a href="#t5811.3  导入模块">11.3  导入模块</a></li><li><a href="#t5911.4 发表文章成功提示">11.4 发表文章成功提示</a></li><li><a href="#t6011.5 增加显示提示的区域">11.5 增加显示提示的区域</a></li><li><a href="#t6111.6  设置模板默认值">11.6  设置模板默认值</a></li></ul></li><li><a href="#t6212. 控制导航">12. 控制导航</a></li><li><a href="#t6313 页面权限控制">13 页面权限控制</a><ul><li><a href="#t6413.1  添加中间件">13.1  添加中间件</a></li><li><a href="#t6513.2   在路由中添加中间件">13.2   在路由中添加中间件</a></li></ul></li><li><a href="#t6614 显示文章列表">14 显示文章列表</a><ul><li><a href="#t6714.1 修改首页模板">14.1 修改首页模板</a></li><li><a href="#t6814.2 修改路由">14.2 修改路由</a></li></ul></li><li><a href="#t6915 支持markdown">15 支持markdown</a><ul><li><a href="#t7015.1 安装markdown">15.1 安装markdown</a></li><li><a href="#t7115.2  修改路由">15.2  修改路由</a></li></ul></li><li><a href="#t7216 文章详情页">16 文章详情页</a><ul><li><a href="#t7316.1   修改首页">16.1   修改首页</a></li><li><a href="#t7416.2 修改路由">16.2 修改路由</a></li><li><a href="#t7516.3 增加详情页">16.3 增加详情页</a></li></ul></li><li><a href="#t7617 删除文章">17 删除文章</a><ul><li><a href="#t7717.1 修改详情页">17.1 修改详情页</a></li><li><a href="#t7817.2 修改路由">17.2 修改路由</a></li></ul></li><li><a href="#t7918 编辑文章">18 编辑文章</a><ul><li><a href="#t8018.1 修改详情页">18.1 修改详情页</a></li><li><a href="#t8118.2 修改添加文章界面">18.2 修改添加文章界面</a></li><li><a href="#t8218.3 修改路由">18.3 修改路由</a></li></ul></li><li><a href="#t8319. 搜索和分页">19. 搜索和分页</a><ul><li><a href="#t8419.1 在导航栏增加搜索框">19.1 在导航栏增加搜索框</a></li><li><a href="#t8519.2  在首页增加分页条">19.2  在首页增加分页条</a></li><li><a href="#t8619.3 首页导航重定向到文章列表页">19.3 首页导航重定向到文章列表页</a></li><li><a href="#t8719.4  增加文章列表导航">19.4  增加文章列表导航</a></li></ul></li><li><a href="#t8820. 实现评论功能">20. 实现评论功能</a><ul><li><a href="#t8920.1 修改模板">20.1 修改模板</a></li><li><a href="#t9020.2 修改模型">20.2 修改模型</a></li><li><a href="#t9120.3  修改路由">20.3  修改路由</a></li></ul></li><li><a href="#t9221 显示PV和评论">21 显示PV和评论</a><ul><li><a href="#t9321.1 安装async">21.1 安装async</a></li><li><a href="#t9421.2 修改模型">21.2 修改模型</a></li><li><a href="#t9521.3 修改路由">21.3 修改路由</a></li><li><a href="#t9621.4 修改模板">21.4 修改模板</a></li></ul></li><li><a href="#t9722. 美化404中间件">22. 美化404中间件</a><ul><li><a href="#t9822.1 修改404中间件">22.1 修改404中间件</a></li><li><a href="#t9922.2 增加404页面模板">22.2 增加404页面模板</a></li></ul></li><li><a href="#t10023 打印日志">23 打印日志</a></li><li><a href="#t10124 发布heroKu">24 发布heroKu</a><ul><li><a href="#t10224.1 注册">24.1 注册</a></li><li><a href="#t10324.2 验证邮箱">24.2 验证邮箱</a></li><li><a href="#t10424.3 查看邮箱点击激活链接">24.3 查看邮箱点击激活链接</a></li><li><a href="#t10524.4 需要设置密码">24.4 需要设置密码</a></li><li><a href="#t10624.5 验证成功">24.5 验证成功</a></li><li><a href="#t10724.6 进入控制面板">24.6 进入控制面板</a></li><li><a href="#t10824.7 输入app名称">24.7 输入app名称</a></li><li><a href="#t10924.8 将此APP关联到github上">24.8 将此APP关联到github上</a></li><li><a href="#t11024.9 点击布署分支">24.9 点击布署分支</a></li><li><a href="#t11124.10 发布结果">24.10 发布结果</a></li></ul></li></ul>
        </div>

        <div class="content markdown-body">

            <h2 id="t01. express&#x751F;&#x6210;&#x5668;&#x751F;&#x6210;&#x751F;&#x6210;&#x9879;&#x76EE;">1. express&#x751F;&#x6210;&#x5668;&#x751F;&#x6210;&#x751F;&#x6210;&#x9879;&#x76EE; <a href="#t01. express&#x751F;&#x6210;&#x5668;&#x751F;&#x6210;&#x751F;&#x6210;&#x9879;&#x76EE;"> # </a></h2>
<h3 id="t11.1 &#x5B89;&#x88C5; Express&#x751F;&#x6210;&#x5668;">1.1 &#x5B89;&#x88C5; Express&#x751F;&#x6210;&#x5668; <a href="#t11.1 &#x5B89;&#x88C5; Express&#x751F;&#x6210;&#x5668;"> # </a></h3>
<p>express &#x662F; Node.js &#x4E0A;&#x6700;&#x6D41;&#x884C;&#x7684; Web &#x5F00;&#x53D1;&#x6846;&#x67B6;&#xFF0C;&#x6B63;&#x5982;&#x4ED6;&#x7684;&#x540D;&#x5B57;&#x4E00;&#x6837;&#xFF0C;&#x4F7F;&#x7528;&#x5B83;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5FEB;&#x901F;&#x7684;&#x5F00;&#x53D1;&#x4E00;&#x4E2A; Web &#x5E94;&#x7528;&#x3002;&#x6211;&#x4EEC;&#x7528; express &#x6765;&#x642D;&#x5EFA;&#x6211;&#x4EEC;&#x7684;&#x535A;&#x5BA2;&#xFF0C;&#x6253;&#x5F00;&#x547D;&#x4EE4;&#x884C;&#xFF0C;&#x8F93;&#x5165;&#xFF1A;</p>
<pre><code class="lang-javascript">$ npm install -g express-generator
</code></pre>
<p>&#x5B89;&#x88C5; express &#x547D;&#x4EE4;&#x884C;&#x5DE5;&#x5177;&#xFF0C;&#x4F7F;&#x7528;&#x5B83;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A; express &#x9879;&#x76EE;&#x3002;</p>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/express.png" class="img-responsive"></p>
<h3 id="t21.2 &#x751F;&#x6210;&#x4E00;&#x4E2A;&#x9879;&#x76EE;">1.2 &#x751F;&#x6210;&#x4E00;&#x4E2A;&#x9879;&#x76EE; <a href="#t21.2 &#x751F;&#x6210;&#x4E00;&#x4E2A;&#x9879;&#x76EE;"> # </a></h3>
<p>&#x5728;&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x8F93;&#x5165;&#xFF1A;</p>
<pre><code class="lang-javascript">$ express -e zhufengpeixunblog
$ cd zhufengpeixunblog &amp;&amp; npm install
</code></pre>
<p>&#x6267;&#x884C;&#x7ED3;&#x679C;&#x4E2D;&#x4F1A;&#x663E;&#x793A;&#x751F;&#x6210;&#x7684;&#x6587;&#x4EF6;&#x5E76;&#x63D0;&#x793A;&#x540E;&#x7EED;&#x7684;&#x547D;&#x4EE4;</p>
<pre><code class="lang-javascript">E:\&gt;express -e zhufengpeixunblog

create : zhufengpeixunblog
create : zhufengpeixunblog/package.json
create : zhufengpeixunblog/app.js
create : zhufengpeixunblog/public
create : zhufengpeixunblog/routes
create : zhufengpeixunblog/routes/index.js
create : zhufengpeixunblog/routes/users.js
create : zhufengpeixunblog/public/images
create : zhufengpeixunblog/public/javascripts
create : zhufengpeixunblog/views
create : zhufengpeixunblog/views/index.ejs
create : zhufengpeixunblog/views/error.ejs
create : zhufengpeixunblog/public/stylesheets
create : zhufengpeixunblog/public/stylesheets/style.css
create : zhufengpeixunblog/bin
create : zhufengpeixunblog/bin/www

install dependencies:
 &gt; cd zhufengpeixunblog &amp;&amp; npm install

run the app:
 &gt; SET DEBUG=zhufengpeixunblog:* &amp; npm start
</code></pre>
<p>&#x8FDB;&#x5165;&#x751F;&#x6210;&#x7684;&#x76EE;&#x5F55;&#x5E76;&#x5B89;&#x88C5;&#x4F9D;&#x8D56;</p>
<pre><code class="lang-javascript">$ E:\&gt;cd zhufengpeixunblog &amp;&amp; npm install

debug@<span class="hljs-number">2.2</span><span class="hljs-number">.0</span> node_modules\debug
&#x2514;&#x2500;&#x2500; ms@<span class="hljs-number">0.7</span><span class="hljs-number">.1</span>

morgan@<span class="hljs-number">1.6</span><span class="hljs-number">.1</span> node_modules\morgan
&#x251C;&#x2500;&#x2500; on-headers@<span class="hljs-number">1.0</span><span class="hljs-number">.1</span>
&#x251C;&#x2500;&#x2500; basic-auth@<span class="hljs-number">1.0</span><span class="hljs-number">.3</span>
&#x251C;&#x2500;&#x2500; depd@<span class="hljs-number">1.0</span><span class="hljs-number">.1</span>
&#x2514;&#x2500;&#x2500; on-finished@<span class="hljs-number">2.3</span><span class="hljs-number">.0</span> (ee-first@<span class="hljs-number">1.1</span><span class="hljs-number">.1</span>)

cookie-parser@<span class="hljs-number">1.3</span><span class="hljs-number">.5</span> node_modules\cookie-parser
&#x251C;&#x2500;&#x2500; cookie@<span class="hljs-number">0.1</span><span class="hljs-number">.3</span>
&#x2514;&#x2500;&#x2500; cookie-signature@<span class="hljs-number">1.0</span><span class="hljs-number">.6</span>

serve-favicon@<span class="hljs-number">2.3</span><span class="hljs-number">.0</span> node_modules\serve-favicon
&#x251C;&#x2500;&#x2500; ms@<span class="hljs-number">0.7</span><span class="hljs-number">.1</span>
&#x251C;&#x2500;&#x2500; etag@<span class="hljs-number">1.7</span><span class="hljs-number">.0</span>
&#x251C;&#x2500;&#x2500; fresh@<span class="hljs-number">0.3</span><span class="hljs-number">.0</span>
&#x2514;&#x2500;&#x2500; parseurl@<span class="hljs-number">1.3</span><span class="hljs-number">.0</span>

body-parser@<span class="hljs-number">1.13</span><span class="hljs-number">.3</span> node_modules\body-parser
&#x251C;&#x2500;&#x2500; bytes@<span class="hljs-number">2.1</span><span class="hljs-number">.0</span>
&#x251C;&#x2500;&#x2500; content-type@<span class="hljs-number">1.0</span><span class="hljs-number">.1</span>
&#x251C;&#x2500;&#x2500; depd@<span class="hljs-number">1.0</span><span class="hljs-number">.1</span>
&#x251C;&#x2500;&#x2500; on-finished@<span class="hljs-number">2.3</span><span class="hljs-number">.0</span> (ee-first@<span class="hljs-number">1.1</span><span class="hljs-number">.1</span>)
&#x251C;&#x2500;&#x2500; qs@<span class="hljs-number">4.0</span><span class="hljs-number">.0</span>
&#x251C;&#x2500;&#x2500; iconv-lite@<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>
&#x251C;&#x2500;&#x2500; http-errors@<span class="hljs-number">1.3</span><span class="hljs-number">.1</span> (statuses@<span class="hljs-number">1.2</span><span class="hljs-number">.1</span>, inherits@<span class="hljs-number">2.0</span><span class="hljs-number">.1</span>)
&#x251C;&#x2500;&#x2500; type-is@<span class="hljs-number">1.6</span><span class="hljs-number">.9</span> (media-typer@<span class="hljs-number">0.3</span><span class="hljs-number">.0</span>, mime-types@<span class="hljs-number">2.1</span><span class="hljs-number">.7</span>)
&#x2514;&#x2500;&#x2500; raw-body@<span class="hljs-number">2.1</span><span class="hljs-number">.4</span> (unpipe@<span class="hljs-number">1.0</span><span class="hljs-number">.0</span>, iconv-lite@<span class="hljs-number">0.4</span><span class="hljs-number">.12</span>)

express@<span class="hljs-number">4.13</span><span class="hljs-number">.3</span> node_modules\express
&#x251C;&#x2500;&#x2500; <span class="hljs-built_in">escape</span>-html@<span class="hljs-number">1.0</span><span class="hljs-number">.2</span>
&#x251C;&#x2500;&#x2500; array-flatten@<span class="hljs-number">1.1</span><span class="hljs-number">.1</span>
&#x251C;&#x2500;&#x2500; path-to-regexp@<span class="hljs-number">0.1</span><span class="hljs-number">.7</span>
&#x251C;&#x2500;&#x2500; merge-descriptors@<span class="hljs-number">1.0</span><span class="hljs-number">.0</span>
&#x251C;&#x2500;&#x2500; content-type@<span class="hljs-number">1.0</span><span class="hljs-number">.1</span>
&#x251C;&#x2500;&#x2500; methods@<span class="hljs-number">1.1</span><span class="hljs-number">.1</span>
&#x251C;&#x2500;&#x2500; utils-merge@<span class="hljs-number">1.0</span><span class="hljs-number">.0</span>
&#x251C;&#x2500;&#x2500; content-disposition@<span class="hljs-number">0.5</span><span class="hljs-number">.0</span>
&#x251C;&#x2500;&#x2500; range-parser@<span class="hljs-number">1.0</span><span class="hljs-number">.3</span>
&#x251C;&#x2500;&#x2500; serve-static@<span class="hljs-number">1.10</span><span class="hljs-number">.0</span>
&#x251C;&#x2500;&#x2500; vary@<span class="hljs-number">1.0</span><span class="hljs-number">.1</span>
&#x251C;&#x2500;&#x2500; depd@<span class="hljs-number">1.0</span><span class="hljs-number">.1</span>
&#x251C;&#x2500;&#x2500; cookie@<span class="hljs-number">0.1</span><span class="hljs-number">.3</span>
&#x251C;&#x2500;&#x2500; cookie-signature@<span class="hljs-number">1.0</span><span class="hljs-number">.6</span>
&#x251C;&#x2500;&#x2500; fresh@<span class="hljs-number">0.3</span><span class="hljs-number">.0</span>
&#x251C;&#x2500;&#x2500; etag@<span class="hljs-number">1.7</span><span class="hljs-number">.0</span>
&#x251C;&#x2500;&#x2500; on-finished@<span class="hljs-number">2.3</span><span class="hljs-number">.0</span> (ee-first@<span class="hljs-number">1.1</span><span class="hljs-number">.1</span>)
&#x251C;&#x2500;&#x2500; parseurl@<span class="hljs-number">1.3</span><span class="hljs-number">.0</span>
&#x251C;&#x2500;&#x2500; qs@<span class="hljs-number">4.0</span><span class="hljs-number">.0</span>
&#x251C;&#x2500;&#x2500; finalhandler@<span class="hljs-number">0.4</span><span class="hljs-number">.0</span> (unpipe@<span class="hljs-number">1.0</span><span class="hljs-number">.0</span>)
&#x251C;&#x2500;&#x2500; accepts@<span class="hljs-number">1.2</span><span class="hljs-number">.13</span> (negotiator@<span class="hljs-number">0.5</span><span class="hljs-number">.3</span>, mime-types@<span class="hljs-number">2.1</span><span class="hljs-number">.7</span>)
&#x251C;&#x2500;&#x2500; type-is@<span class="hljs-number">1.6</span><span class="hljs-number">.9</span> (media-typer@<span class="hljs-number">0.3</span><span class="hljs-number">.0</span>, mime-types@<span class="hljs-number">2.1</span><span class="hljs-number">.7</span>)
&#x251C;&#x2500;&#x2500; proxy-addr@<span class="hljs-number">1.0</span><span class="hljs-number">.8</span> (forwarded@<span class="hljs-number">0.1</span><span class="hljs-number">.0</span>, ipaddr.js@<span class="hljs-number">1.0</span><span class="hljs-number">.1</span>)
</code></pre>
<p>&#x8BBE;&#x7F6E;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x5E76;&#x542F;&#x52A8;&#x670D;&#x52A1;&#x5668;,&#x5728;&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x6267;&#x884C;&#x4E0B;&#x5217;&#x547D;&#x4EE4;</p>
<pre><code class="lang-javascript">$ SET DEBUG=zhufengpeixunblog:* &amp; npm start
</code></pre>
<p>&#x6267;&#x884C;&#x5B8C;&#x6210;&#x540E;&#x4F1A;&#x663E;&#x793A;</p>
<pre><code class="lang-javascript">zhufengpeixunblog:server Listening on port <span class="hljs-number">3000</span> +<span class="hljs-number">0</span>ms
</code></pre>
<p>&#x5728;&#x6D4F;&#x89C8;&#x5668;&#x91CC;&#x8BBF;&#x95EE; <a href="http://localhost:3000">http://localhost:3000</a> &#x5C31;&#x53EF;&#x4EE5;&#x663E;&#x793A;&#x6B22;&#x8FCE;&#x9875;&#x9762;</p>
<pre><code class="lang-javascript">Express
Welcome to Express
</code></pre>
<p>&#x521A;&#x624D;&#x6211;&#x4EEC;&#x5C31;&#x7528;express&#x751F;&#x6210;&#x5668;&#x751F;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;ejs&#x6A21;&#x677F;&#x7684;&#x793A;&#x4F8B;&#x5DE5;&#x7A0B;&#x3002;</p>
<h3 id="t31.3 debug">1.3 debug <a href="#t31.3 debug"> # </a></h3>
<p>debug&#x6A21;&#x5757;</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> colors = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;colors&apos;</span>);
colors.setTheme({
    name: <span class="hljs-string">&apos;cyan&apos;</span>,
    cost: <span class="hljs-string">&apos;green&apos;</span>
});
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>)</span>{
   <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg</span>)</span>{
     <span class="hljs-keyword">var</span> start = <span class="hljs-built_in">Date</span>.now();
     <span class="hljs-comment">//&#x5224;&#x65AD;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4E2D;&#x7684;DEUBG&#x7684;&#x503C;&#x662F;&#x662F;&#x5426;&#x5339;&#x914D;&#x5F53;&#x524D;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x5668;&#x7684;&#x540D;&#x79F0;</span>
     <span class="hljs-keyword">var</span> env = process.env.DEBUG;
     env = env.replace(<span class="hljs-string">&apos;*&apos;</span>,<span class="hljs-string">&apos;.*&apos;</span>)
     <span class="hljs-keyword">if</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(env).test(name)){
         <span class="hljs-built_in">console</span>.log(name.name,msg,(<span class="hljs-string">&apos;+&apos;</span>+(<span class="hljs-built_in">Date</span>.now()-start)+<span class="hljs-string">&apos;ms&apos;</span>).cost);
     }
   }
}
</code></pre>
<p>&#x4F7F;&#x7528;debug&#x6A21;&#x5757;</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> debug = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./debug&apos;</span>);
<span class="hljs-comment">//&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x5668; &#x540D;&#x5B57;&#x53EB;warn&apos;</span>
<span class="hljs-comment">// set DEBUG=logger:*</span>
<span class="hljs-keyword">var</span> logger_warn = debug(<span class="hljs-string">&apos;logger:warn&apos;</span>);
logger_warn(<span class="hljs-string">&apos;warn&apos;</span>);

<span class="hljs-comment">//&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x5668; &#x540D;&#x5B57;&#x53EB;error</span>
<span class="hljs-keyword">var</span> logger_error = debug(<span class="hljs-string">&apos;logger:error&apos;</span>);
logger_error(<span class="hljs-string">&apos;error&apos;</span>);
</code></pre>
<h2 id="t42. &#x9879;&#x76EE;&#x6587;&#x4EF6;&#x5206;&#x6790;">2. &#x9879;&#x76EE;&#x6587;&#x4EF6;&#x5206;&#x6790; <a href="#t42. &#x9879;&#x76EE;&#x6587;&#x4EF6;&#x5206;&#x6790;"> # </a></h2>
<h3 id="t52.1 &#x751F;&#x6210;&#x6587;&#x4EF6;&#x8BF4;&#x660E;">2.1 &#x751F;&#x6210;&#x6587;&#x4EF6;&#x8BF4;&#x660E; <a href="#t52.1 &#x751F;&#x6210;&#x6587;&#x4EF6;&#x8BF4;&#x660E;"> # </a></h3>
<ul>
<li><strong>app.js</strong>&#xFF1A;express&#x7684;&#x4E3B;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</li>
<li><strong>package.json</strong>&#xFF1A;&#x5B58;&#x50A8;&#x7740;&#x5DE5;&#x7A0B;&#x7684;&#x4FE1;&#x606F;&#x53CA;&#x6A21;&#x5757;&#x4F9D;&#x8D56;&#xFF0C;&#x5F53;&#x5728; dependencies &#x4E2D;&#x6DFB;&#x52A0;&#x4F9D;&#x8D56;&#x7684;&#x6A21;&#x5757;&#x65F6;&#xFF0C;&#x8FD0;&#x884C; <code>npm install</code>&#xFF0C;npm &#x4F1A;&#x68C0;&#x67E5;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x4E0B;&#x7684; package.json&#xFF0C;&#x5E76;&#x81EA;&#x52A8;&#x5B89;&#x88C5;&#x6240;&#x6709;&#x6307;&#x5B9A;&#x7684;&#x6A21;&#x5757;</li>
<li><strong>node_modules</strong>&#xFF1A;&#x5B58;&#x653E; package.json &#x4E2D;&#x5B89;&#x88C5;&#x7684;&#x6A21;&#x5757;&#xFF0C;&#x5F53;&#x4F60;&#x5728; package.json &#x6DFB;&#x52A0;&#x4F9D;&#x8D56;&#x7684;&#x6A21;&#x5757;&#x5E76;&#x5B89;&#x88C5;&#x540E;&#xFF0C;&#x5B58;&#x653E;&#x5728;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x4E0B;</li>
<li><strong>public</strong>&#xFF1A;&#x5B58;&#x653E; image&#x3001;css&#x3001;js &#x7B49;&#x6587;&#x4EF6;</li>
<li><strong>routes</strong>&#xFF1A;&#x5B58;&#x653E;&#x8DEF;&#x7531;&#x6587;&#x4EF6;</li>
<li><strong>views</strong>&#xFF1A;&#x5B58;&#x653E;&#x89C6;&#x56FE;&#x6587;&#x4EF6;&#x6216;&#x8005;&#x8BF4;&#x6A21;&#x7248;&#x6587;&#x4EF6;</li>
<li><strong>bin</strong>&#xFF1A;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#xFF0C;&#x53EF;&#x4EE5;&#x4ECE;&#x6B64;&#x542F;&#x52A8;&#x670D;&#x52A1;&#x5668;</li>
</ul>
<h3 id="t62.2 app.js">2.2 app.js <a href="#t62.2 app.js"> # </a></h3>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;express&apos;</span>); &#x52A0;&#x8F7D;node_modules&#x4E0B;&#x7684;express&#x6A21;&#x5757;
<span class="hljs-keyword">var</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;path&apos;</span>);
<span class="hljs-keyword">var</span> favicon = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;serve-favicon&apos;</span>);
<span class="hljs-keyword">var</span> logger = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;morgan&apos;</span>);
<span class="hljs-keyword">var</span> cookieParser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;cookie-parser&apos;</span>);
<span class="hljs-keyword">var</span> bodyParser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;body-parser&apos;</span>);

<span class="hljs-keyword">var</span> routes = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./routes/index&apos;</span>);
<span class="hljs-keyword">var</span> users = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./routes/users&apos;</span>);

<span class="hljs-keyword">var</span> app = express(); &#x751F;&#x6210;&#x4E00;&#x4E2A;express&#x5B9E;&#x4F8B; app

<span class="hljs-comment">// &#x8BBE;&#x7F6E; views &#x6587;&#x4EF6;&#x5939;&#x4E3A;&#x5B58;&#x653E;&#x89C6;&#x56FE;&#x6587;&#x4EF6;&#x7684;&#x76EE;&#x5F55;, &#x5373;&#x5B58;&#x653E;&#x6A21;&#x677F;&#x6587;&#x4EF6;&#x7684;&#x5730;&#x65B9;,</span>
app.set(<span class="hljs-string">&apos;views&apos;</span>, path.join(__dirname, <span class="hljs-string">&apos;views&apos;</span>));
app.set(<span class="hljs-string">&apos;view engine&apos;</span>, <span class="hljs-string">&apos;ejs&apos;</span>); &#x8BBE;&#x7F6E;&#x89C6;&#x56FE;&#x6A21;&#x677F;&#x5F15;&#x64CE;&#x4E3A; ejs&#x3002;

<span class="hljs-comment">//&#x8BBE;&#x7F6E;/public/favicon.ico&#x4E3A;favicon&#x56FE;&#x6807;</span>
<span class="hljs-comment">//app.use(favicon(path.join(__dirname, &apos;public&apos;, &apos;favicon.ico&apos;)));</span>
app.use(logger(<span class="hljs-string">&apos;dev&apos;</span>)); &#x52A0;&#x8F7D;&#x65E5;&#x5FD7;&#x4E2D;&#x95F4;&#x4EF6;&#x3002;
app.use(bodyParser.json()); &#x52A0;&#x8F7D;&#x89E3;&#x6790;json&#x7684;&#x4E2D;&#x95F4;&#x4EF6;&#x3002;
<span class="hljs-comment">//&#x52A0;&#x8F7D;&#x89E3;&#x6790;urlencoded&#x8BF7;&#x6C42;&#x4F53;&#x7684;&#x4E2D;&#x95F4;&#x4EF6;&#x3002;</span>
app.use(bodyParser.urlencoded({ extended: <span class="hljs-literal">false</span> }));
app.use(cookieParser()); &#x52A0;&#x8F7D;&#x89E3;&#x6790;cookie&#x7684;&#x4E2D;&#x95F4;&#x4EF6;&#x3002;
/&#x8BBE;&#x7F6E;public&#x6587;&#x4EF6;&#x5939;&#x4E3A;&#x5B58;&#x653E;&#x9759;&#x6001;&#x6587;&#x4EF6;&#x7684;&#x76EE;&#x5F55;&#x3002;
app.use(express.static(path.join(__dirname, <span class="hljs-string">&apos;public&apos;</span>)));

app.use(<span class="hljs-string">&apos;/&apos;</span>, routes); &#x6839;&#x76EE;&#x5F55;&#x7684;&#x8DEF;&#x7531;
app.use(<span class="hljs-string">&apos;/users&apos;</span>, users); &#x7528;&#x6237;&#x8DEF;&#x7531;

<span class="hljs-comment">// &#x6355;&#x83B7;404&#x9519;&#x8BEF;&#xFF0C;&#x5E76;&#x8F6C;&#x53D1;&#x5230;&#x9519;&#x8BEF;&#x5904;&#x7406;&#x5668;&#x3002;</span>
app.use(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>) </span>{
  <span class="hljs-keyword">var</span> err = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&apos;Not Found&apos;</span>);
  err.status = <span class="hljs-number">404</span>;
  next(err);
});

<span class="hljs-comment">// error handlers &#x9519;&#x8BEF;&#x5904;&#x7406;&#x5668;</span>
<span class="hljs-comment">// development error handler &#x5F00;&#x53D1;&#x73AF;&#x5883;&#x4E0B;&#x7684;&#x9519;&#x8BEF;&#x5904;&#x7406;</span>
<span class="hljs-comment">// will print stacktrace &#x5C06;&#x6253;&#x5370;&#x51FA;&#x5806;&#x6808;&#x4FE1;&#x606F;</span>
<span class="hljs-keyword">if</span> (app.get(<span class="hljs-string">&apos;env&apos;</span>) === <span class="hljs-string">&apos;development&apos;</span>) {
  app.use(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, req, res, next</span>) </span>{
res.status(err.status || <span class="hljs-number">500</span>);
res.render(<span class="hljs-string">&apos;error&apos;</span>, {
  message: err.message,
  error: err
});
  });
}

<span class="hljs-comment">//&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x4E0B;&#x7684;&#x9519;&#x8BEF;&#x5904;&#x7406;</span>
<span class="hljs-comment">// &#x4E0D;&#x5411;&#x7528;&#x6237;&#x66B4;&#x9732;&#x5806;&#x6808;&#x4FE1;&#x606F;</span>
app.use(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, req, res, next</span>) </span>{
  res.status(err.status || <span class="hljs-number">500</span>);
  res.render(<span class="hljs-string">&apos;error&apos;</span>, {
message: err.message,
error: {}
  });
});


<span class="hljs-built_in">module</span>.exports = app;  &#x5BFC;&#x51FA;app&#x4F9B; bin/www &#x4F7F;&#x7528;
</code></pre>
<h3 id="t72.3 bin/www">2.3 bin/www <a href="#t72.3 bin/www"> # </a></h3>
<pre><code class="lang-javascript">!<span class="hljs-regexp">/usr/</span>bin/env node  &#x8868;&#x660E;&#x662F; node &#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x3002;

<span class="hljs-comment">//&#x5F15;&#x5165;&#x6211;&#x4EEC;&#x4E0A;&#x9762;app.js&#x5BFC;&#x51FA;&#x7684;app&#x5B9E;&#x4F8B;</span>
<span class="hljs-keyword">var</span> app = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;../app&apos;</span>);
<span class="hljs-comment">//&#x5F15;&#x5165;&#x6253;&#x5370;&#x8C03;&#x8BD5;&#x65E5;&#x5FD7;&#x7684;debug&#x6A21;&#x5757;&#xFF0C;&#x5E76;&#x8BBE;&#x7F6E;&#x540D;&#x79F0;&#x3002;</span>
<span class="hljs-keyword">var</span> debug = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;debug&apos;</span>)(<span class="hljs-string">&apos;zhufengpeixunblog:server&apos;</span>);
<span class="hljs-keyword">var</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;http&apos;</span>);

<span class="hljs-comment">//&#x4ECE;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4E2D;&#x83B7;&#x53D6;&#x7AEF;&#x53E3;&#x53F7;&#x5E76;&#x5B58;&#x653E;&#x5230;express&#x4E2D;</span>
<span class="hljs-keyword">var</span> port = normalizePort(process.env.PORT || <span class="hljs-string">&apos;3000&apos;</span>);
<span class="hljs-comment">//&#x8BBE;&#x7F6E;&#x7AEF;&#x53E3;&#x53F7;</span>
app.set(<span class="hljs-string">&apos;port&apos;</span>, port);

<span class="hljs-comment">//&#x521B;&#x5EFA;http&#x670D;&#x52A1;&#x5668;</span>
<span class="hljs-keyword">var</span> server = http.createServer(app);

<span class="hljs-comment">//&#x5728;&#x6240;&#x6709;&#x7684;&#x7F51;&#x7EDC;&#x63A5;&#x53E3;&#x4E2D;&#x76D1;&#x542C;&#x63D0;&#x4F9B;&#x7684;&#x7AEF;&#x53E3;</span>
server.listen(port);
<span class="hljs-comment">//&#x76D1;&#x542C;&#x9519;&#x8BEF;&#x4E8B;&#x4EF6;</span>
server.on(<span class="hljs-string">&apos;error&apos;</span>, onError);
<span class="hljs-comment">//&#x542F;&#x52A8;&#x5DE5;&#x7A0B;&#x5E76;&#x76D1;&#x542C;3000&#x7AEF;&#x53E3;&#xFF0C;&#x6210;&#x529F;&#x540E;&#x6253;&#x5370; &#x3002;</span>
server.on(<span class="hljs-string">&apos;listening&apos;</span>, onListening);
<span class="hljs-comment">//&#x628A;&#x4E00;&#x4E2A;&#x7AEF;&#x53E3;&#x5904;&#x7406;&#x6210;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#x6216;&#x5B57;&#x7B26;&#x4E32;&#x6216;&#x8005;false</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">normalizePort</span>(<span class="hljs-params">val</span>) </span>{
 <span class="hljs-comment">//&#x5148;&#x8BD5;&#x56FE;&#x8F6C;&#x6210;10&#x8FDB;&#x5236;&#x6570;&#x5B57;</span>
  <span class="hljs-keyword">var</span> port = <span class="hljs-built_in">parseInt</span>(val, <span class="hljs-number">10</span>);

  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(port)) {
<span class="hljs-comment">// &#x8F6C;&#x4E0D;&#x6210;&#x6570;&#x5B57;&#x5C31;&#x5F53;&#x4F5C;&#x547D;&#x540D;&#x7BA1;&#x9053;&#x6765;&#x5904;&#x7406;</span>
<span class="hljs-keyword">return</span> val;
  }

  <span class="hljs-keyword">if</span> (port &gt;= <span class="hljs-number">0</span>) {
<span class="hljs-comment">// port number &#x5982;&#x679C;&#x7AEF;&#x53E3;&#x5927;&#x4E8E;0&#x5C31;&#x8FD4;&#x56DE;&#x7AEF;&#x53E3;</span>
<span class="hljs-keyword">return</span> port;
  }
<span class="hljs-comment">//&#x4E0D;&#x662F;&#x547D;&#x540D;&#x7BA1;&#x9053;&#xFF0C;&#x4E5F;&#x4E0D;&#x662F;&#x6B63;&#x5E38;&#x7AEF;&#x53E3;&#x5C31;&#x8FD4;&#x56DE;false</span>
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-comment">//&#x670D;&#x52A1;&#x5668;&#x7684;&#x9519;&#x8BEF;&#x4E8B;&#x4EF6;&#x76D1;&#x542C;&#x5668;</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onError</span>(<span class="hljs-params">error</span>) </span>{
 <span class="hljs-comment">//&#x5982;&#x679C;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E0D;&#x662F;&#x76D1;&#x542C;&#x5219;&#x629B;&#x51FA;&#x9519;&#x8BEF;</span>
  <span class="hljs-keyword">if</span> (error.syscall !== <span class="hljs-string">&apos;listen&apos;</span>) {
<span class="hljs-keyword">throw</span> error;
  }
  <span class="hljs-keyword">var</span> bind = <span class="hljs-keyword">typeof</span> port === <span class="hljs-string">&apos;string&apos;</span>
? <span class="hljs-string">&apos;Pipe &apos;</span> + port
: <span class="hljs-string">&apos;Port &apos;</span> + port;

  <span class="hljs-comment">//&#x66F4;&#x53CB;&#x597D;&#x7684;&#x5904;&#x7406;&#x7279;&#x5B9A;&#x7684;&#x76D1;&#x542C;&#x9519;&#x8BEF;</span>
  <span class="hljs-keyword">switch</span> (error.code) { &#x9519;&#x8BEF;&#x7F16;&#x7801;
<span class="hljs-keyword">case</span> <span class="hljs-string">&apos;EACCES&apos;</span>: &#x6CA1;&#x6709;&#x6743;&#x9650;
  <span class="hljs-comment">//&#x6CA1;&#x6709;&#x6743;&#x9650;&#x7ED1;&#x5B9A;&#x6307;&#x5B9A;&#x7684;&#x7AEF;&#x53E3;</span>
  <span class="hljs-built_in">console</span>.error(bind + <span class="hljs-string">&apos; requires elevated privileges&apos;</span>);
  process.exit(<span class="hljs-number">1</span>); &#x5F02;&#x5E38;&#x9000;&#x51FA;
  <span class="hljs-keyword">break</span>;
<span class="hljs-keyword">case</span> <span class="hljs-string">&apos;EADDRINUSE&apos;</span>: &#x7AEF;&#x53E3;&#x88AB;&#x5360;&#x7528;
  <span class="hljs-built_in">console</span>.error(bind + <span class="hljs-string">&apos; is already in use&apos;</span>);
  process.exit(<span class="hljs-number">1</span>);&#x5F02;&#x5E38;&#x9000;&#x51FA;
  <span class="hljs-keyword">break</span>;
<span class="hljs-keyword">default</span>:
<span class="hljs-comment">//&#x5176;&#x5B83;&#x7684;&#x60C5;&#x51B5;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x5E76;&#x4E2D;&#x6B62;&#x8FDB;&#x7A0B;</span>
  <span class="hljs-keyword">throw</span> error;
  }
}

<span class="hljs-comment">//&#x670D;&#x52A1;&#x5668;&#x7684;&#x76D1;&#x542C;&#x7AEF;&#x53E3;&#x6210;&#x529F;&#x4E8B;&#x4EF6;&#x56DE;&#x8C03;</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onListening</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-comment">//&#x53D6;&#x5F97;&#x670D;&#x52A1;&#x5668;&#x7684;&#x5730;&#x5740;</span>
  <span class="hljs-keyword">var</span> addr = server.address();
<span class="hljs-comment">//&#x76D1;&#x542C;&#x5730;&#x5740;&#x5982;&#x679C;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#x8FD4;&#x56DE;&#x547D;&#x540D;&#x7BA1;&#x9053;&#x540D;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x6570;&#x5B57;&#x8FD4;&#x56DE;&#x7AEF;&#x53E3;</span>
  <span class="hljs-keyword">var</span> bind = <span class="hljs-keyword">typeof</span> addr === <span class="hljs-string">&apos;string&apos;</span>
? <span class="hljs-string">&apos;pipe &apos;</span> + addr
: <span class="hljs-string">&apos;port &apos;</span> + addr.port;
<span class="hljs-comment">//&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;</span>
  debug(<span class="hljs-string">&apos;Listening on &apos;</span> + bind);
}
</code></pre>
<h3 id="t82.4 routes/index.js">2.4 routes/index.js <a href="#t82.4 routes/index.js"> # </a></h3>
<pre><code class="lang-javascript"><span class="hljs-comment">//&#x5BFC;&#x5165;express&#x6A21;&#x5757;</span>
<span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;express&apos;</span>);
<span class="hljs-comment">//&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x8DEF;&#x7531;&#x5B9E;&#x4F8B;</span>
<span class="hljs-keyword">var</span> router = express.Router();

<span class="hljs-comment">//&#x5F53;&#x7528;&#x6237;&#x8BBF;&#x95EE;&#x6839;&#x76EE;&#x5F55;&#x4E5F;&#x5C31;&#x662F; / &#x7684;&#x65F6;&#x5019;&#x6267;&#x884C;&#x6B64;&#x56DE;&#x8C03;</span>
router.get(<span class="hljs-string">&apos;/&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>) </span>{
<span class="hljs-comment">//&#x6E32;&#x67D3;views/index.ejs&#x6A21;&#x7248;&#x5E76;&#x663E;&#x793A;&#x5230;&#x6D4F;&#x89C8;&#x5668;&#x4E2D;</span>
  res.render(<span class="hljs-string">&apos;index&apos;</span>, { title: <span class="hljs-string">&apos;Express&apos;</span> });
});
<span class="hljs-comment">//&#x5BFC;&#x51FA;&#x8FD9;&#x4E2A;&#x8DEF;&#x7531;&#x5E76;&#x5728;app.js&#x4E2D;&#x901A;&#x8FC7;app.use(&apos;/&apos;, routes); &#x52A0;&#x8F7D;</span>
<span class="hljs-built_in">module</span>.exports = router;
</code></pre>
<h3 id="t92.5 views/index.ejs">2.5 views/index.ejs <a href="#t92.5 views/index.ejs"> # </a></h3>
<p>&#x5728;&#x6E32;&#x67D3;&#x6A21;&#x677F;&#x65F6;&#x6211;&#x4EEC;&#x4F20;&#x5165;&#x4E86;&#x4E00;&#x4E2A;&#x53D8;&#x91CF; title &#x503C;&#x4E3A; express &#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x6A21;&#x677F;&#x5F15;&#x64CE;&#x4F1A;&#x5C06;&#x6240;&#x6709; &lt;%= title %&gt; &#x66FF;&#x6362;&#x4E3A; express &#xFF0C;&#x7136;&#x540E;&#x5C06;&#x6E32;&#x67D3;&#x540E;&#x751F;&#x6210;&#x7684;html&#x663E;&#x793A;&#x5230;&#x6D4F;&#x89C8;&#x5668;&#x4E2D;</p>
<pre><code class="lang-html"><span class="hljs-doctype">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">%=</span> <span class="hljs-attribute">title</span> %&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">link</span> <span class="hljs-attribute">rel</span>=<span class="hljs-value">&apos;stylesheet&apos;</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&apos;/stylesheets/style.css&apos;</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">%=</span> <span class="hljs-attribute">title</span> %&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span>Welcome to <span class="hljs-tag">&lt;<span class="hljs-title">%=</span> <span class="hljs-attribute">title</span> %&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
</code></pre>
<h2 id="t103. &#x529F;&#x80FD;&#x4E0E;&#x8BBE;&#x8BA1;">3. &#x529F;&#x80FD;&#x4E0E;&#x8BBE;&#x8BA1; <a href="#t103. &#x529F;&#x80FD;&#x4E0E;&#x8BBE;&#x8BA1;"> # </a></h2>
<h3 id="t113.1 &#x529F;&#x80FD;&#x5206;&#x6790;">3.1 &#x529F;&#x80FD;&#x5206;&#x6790; <a href="#t113.1 &#x529F;&#x80FD;&#x5206;&#x6790;"> # </a></h3>
<p>&#x642D;&#x5EFA;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5177;&#x6709;&#x591A;&#x4EBA;&#x6CE8;&#x518C;&#x3001;&#x767B;&#x5F55;&#x3001;&#x53D1;&#x8868;&#x6587;&#x7AE0;&#x3001;&#x767B;&#x51FA;&#x529F;&#x80FD;&#x7684;&#x535A;&#x5BA2;&#x3002;</p>
<h3 id="t123.2 &#x8BBE;&#x8BA1;&#x76EE;&#x6807;">3.2 &#x8BBE;&#x8BA1;&#x76EE;&#x6807; <a href="#t123.2 &#x8BBE;&#x8BA1;&#x76EE;&#x6807;"> # </a></h3>
<ul>
<li>&#x672A;&#x767B;&#x5F55;&#xFF1A;&#x4E3B;&#x9875;&#x5BFC;&#x822A;&#x663E;&#x793A; &#x9996;&#x9875;&#x3001;&#x6CE8;&#x518C;&#x3001;&#x767B;&#x9646;&#xFF0C;&#x4E0B;&#x9762;&#x663E;&#x793A;&#x5DF2;&#x53D1;&#x8868;&#x7684;&#x6587;&#x7AE0;&#x3001;&#x53D1;&#x8868;&#x65E5;&#x671F;&#x53CA;&#x4F5C;&#x8005;&#x3002;</li>
<li>&#x767B;&#x9646;&#x540E;&#xFF1A;&#x4E3B;&#x9875;&#x5BFC;&#x822A;&#x663E;&#x793A; &#x9996;&#x9875;&#x3001;&#x53D1;&#x8868;&#x6587;&#x7AE0;&#x3001;&#x9000;&#x51FA;&#xFF0C;&#x4E0B;&#x9762;&#x663E;&#x793A;&#x5DF2;&#x53D1;&#x8868;&#x7684;&#x6587;&#x7AE0;&#x3001;&#x53D1;&#x8868;&#x65E5;&#x671F;&#x53CA;&#x4F5C;&#x8005;&#x3002;</li>
<li>&#x7528;&#x6237;&#x767B;&#x5F55;&#x3001;&#x6CE8;&#x518C;&#x3001;&#x53D1;&#x8868;&#x6210;&#x529F;&#x4EE5;&#x53CA;&#x767B;&#x51FA;&#x540E;&#x90FD;&#x8FD4;&#x56DE;&#x5230;&#x4E3B;&#x9875;&#x3002;</li>
</ul>
<h3 id="t133.3 &#x672A;&#x767B;&#x5F55;">3.3 &#x672A;&#x767B;&#x5F55; <a href="#t133.3 &#x672A;&#x767B;&#x5F55;"> # </a></h3>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/logout.jpg" class="img-responsive"></p>
<h3 id="t143.4 &#x767B;&#x9646;&#x540E;">3.4 &#x767B;&#x9646;&#x540E; <a href="#t143.4 &#x767B;&#x9646;&#x540E;"> # </a></h3>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/loged.jpg" class="img-responsive"></p>
<h3 id="t153.4 &#x53D1;&#x8868;&#x6587;&#x7AE0;">3.4 &#x53D1;&#x8868;&#x6587;&#x7AE0; <a href="#t153.4 &#x53D1;&#x8868;&#x6587;&#x7AE0;"> # </a></h3>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/publisharticle.jpg" class="img-responsive"></p>
<h2 id="t164. &#x914D;&#x7F6E;&#x8DEF;&#x7531;">4. &#x914D;&#x7F6E;&#x8DEF;&#x7531; <a href="#t164. &#x914D;&#x7F6E;&#x8DEF;&#x7531;"> # </a></h2>
<h3 id="t174.1 &#x8DEF;&#x7531;&#x89C4;&#x5212;">4.1 &#x8DEF;&#x7531;&#x89C4;&#x5212; <a href="#t174.1 &#x8DEF;&#x7531;&#x89C4;&#x5212;"> # </a></h3>
<p>&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x628A;&#x8BBE;&#x8BA1;&#x7684;&#x6784;&#x60F3;&#x56FE;&#x8D34;&#x51FA;&#x6765;&#x4E86;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x4EFB;&#x52A1;&#x5C31;&#x662F;&#x5B8C;&#x6210;&#x8DEF;&#x7531;&#x89C4;&#x5212;&#x4E86;&#x3002;&#x8DEF;&#x7531;&#x89C4;&#x5212;&#xFF0C;&#x6216;&#x8005;&#x8BF4;&#x63A7;&#x5236;&#x5668;&#x89C4;&#x5212;&#x662F;&#x6574;&#x4E2A;&#x7F51;&#x7AD9;&#x7684;&#x9AA8;&#x67B6;&#x90E8;&#x5206;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x5904;&#x4E8E;&#x6574;&#x4E2A;&#x67B6;&#x6784;&#x7684;&#x67A2;&#x7EBD;&#x4F4D;&#x7F6E;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x5404;&#x4E2A;&#x63A5;&#x53E3;&#x4E4B;&#x95F4;&#x7684;&#x7C98;&#x5408;&#x5242;&#xFF0C;&#x6240;&#x4EE5;&#x5E94;&#x8BE5;&#x4F18;&#x5148;&#x8003;&#x8651;&#x3002;</p>
<blockquote>
<p>&#x6CE8;&#x610F;&#x5B9E;&#x73B0;&#x8DEF;&#x7531;&#x7684;&#x65F6;&#x5019;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x51FA;&#x9519;&#xFF0C;&#x65B0;&#x589E;&#x52A0;&#x7684;&#x6240;&#x6709;&#x7684;&#x8DEF;&#x5F84;&#x3001;&#x6587;&#x4EF6;&#x540D;&#x7EA6;&#x5B9A;&#x90FD;&#x4E0D;&#x8981;&#x52A0;<code>s</code></p>
</blockquote>
<ul>
<li>/ &#xFF1A;&#x9996;&#x9875;</li>
<li>/user/login &#xFF1A;&#x7528;&#x6237;&#x767B;&#x5F55;</li>
<li>/user/reg &#xFF1A;&#x7528;&#x6237;&#x6CE8;&#x518C;</li>
<li>/user/logout &#xFF1A;&#x767B;&#x51FA;</li>
<li>/article/post &#xFF1A;&#x53D1;&#x8868;&#x6587;&#x7AE0;</li>
</ul>
<h3 id="t184.2 &#x589E;&#x52A0;&#x8DEF;&#x7531;">4.2 &#x589E;&#x52A0;&#x8DEF;&#x7531; <a href="#t184.2 &#x589E;&#x52A0;&#x8DEF;&#x7531;"> # </a></h3>
<p>routes/user.js &#x4E2D;&#x6DFB;&#x52A0;&#x4E0B;&#x5217;&#x4EE3;&#x7801;</p>
<pre><code class="lang-javascript"><span class="hljs-comment">/**
 * &#x7528;&#x6237;&#x6CE8;&#x518C;
 */</span>
router.get(<span class="hljs-string">&apos;/reg&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
res.render(<span class="hljs-string">&apos;user/reg&apos;</span>, {title: <span class="hljs-string">&apos;&#x6CE8;&#x518C;&apos;</span>});
});

<span class="hljs-comment">/**
 * &#x5F53;&#x586B;&#x5199;&#x7528;&#x6237;&#x6CE8;&#x518C;&#x4FE1;&#x606F;&#x63D0;&#x4EA4;&#x65F6;&#x7684;&#x5904;&#x7406;
 */</span>
router.post(<span class="hljs-string">&apos;/reg&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
});

<span class="hljs-comment">/**
 * &#x663E;&#x793A;&#x7528;&#x6237;&#x767B;&#x5F55;&#x8868;&#x5355;
 */</span>
router.get(<span class="hljs-string">&apos;/login&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
res.render(<span class="hljs-string">&apos;user/login&apos;</span>, {title: <span class="hljs-string">&apos;&#x767B;&#x5F55;&apos;</span>});
});

<span class="hljs-comment">/**
 * &#x5F53;&#x586B;&#x5199;&#x7528;&#x6237;&#x767B;&#x5F55;&#x4FE1;&#x606F;&#x63D0;&#x4EA4;&#x65F6;&#x7684;&#x5904;&#x7406;
 */</span>
router.post(<span class="hljs-string">&apos;/login&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
});

router.get(<span class="hljs-string">&apos;/logout&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
});

routes/articles.js &#x4E2D;&#x6DFB;&#x52A0;&#x4E0B;&#x5217;&#x4EE3;&#x7801;

router.get(<span class="hljs-string">&apos;/add&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
res.render(<span class="hljs-string">&apos;article/add&apos;</span>, { title: <span class="hljs-string">&apos;&#x53D1;&#x8868;&#x6587;&#x7AE0;&apos;</span> });
});

router.post(<span class="hljs-string">&apos;/add&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{

});
</code></pre>
<h3 id="t194.3 &#x4FEE;&#x6539;app.js">4.3 &#x4FEE;&#x6539;app.js <a href="#t194.3 &#x4FEE;&#x6539;app.js"> # </a></h3>
<p>app.js&#x4E2D;&#x6DFB;&#x52A0;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> article = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./routes/article&apos;</span>);
app.use(<span class="hljs-string">&apos;/article&apos;</span>, article);
</code></pre>
<h3 id="t204.4 &#x589E;&#x52A0;&#x6A21;&#x677F;">4.4 &#x589E;&#x52A0;&#x6A21;&#x677F; <a href="#t204.4 &#x589E;&#x52A0;&#x6A21;&#x677F;"> # </a></h3>
<p>views&#x4E0B;&#x589E;&#x52A0;&#x4EE5;&#x4E0B;&#x6587;&#x4EF6;</p>
<h4 id="t214.4.1 views/article/add.ejs">4.4.1 views/article/add.ejs <a href="#t214.4.1 views/article/add.ejs"> # </a></h4>
<pre><code class="lang-javascript">&lt;%= title %&gt;
</code></pre>
<h4 id="t224.4.2 views/user/login.ejs">4.4.2 views/user/login.ejs <a href="#t224.4.2 views/user/login.ejs"> # </a></h4>
<pre><code class="lang-javascript">&lt;%= title %&gt;
</code></pre>
<h4 id="t234.4.3 views/user/reg.ejs">4.4.3 views/user/reg.ejs <a href="#t234.4.3 views/user/reg.ejs"> # </a></h4>
<pre><code class="lang-javascript">&lt;%= title %&gt;
</code></pre>
<h3 id="t244.5 &#x663E;&#x793A;&#x6548;&#x679C;">4.5 &#x663E;&#x793A;&#x6548;&#x679C; <a href="#t244.5 &#x663E;&#x793A;&#x6548;&#x679C;"> # </a></h3>
<h4 id="t254.5.1 &#x7528;&#x6237;&#x6CE8;&#x518C;">4.5.1 &#x7528;&#x6237;&#x6CE8;&#x518C; <a href="#t254.5.1 &#x7528;&#x6237;&#x6CE8;&#x518C;"> # </a></h4>
<p><a href="http://localhost:3000/user/reg">http://localhost:3000/user/reg</a></p>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/reg.jpg" class="img-responsive"></p>
<h4 id="t264.5.2 &#x7528;&#x6237;&#x767B;&#x9646;">4.5.2 &#x7528;&#x6237;&#x767B;&#x9646; <a href="#t264.5.2 &#x7528;&#x6237;&#x767B;&#x9646;"> # </a></h4>
<p><a href="http://localhost:3000/user/login">http://localhost:3000/user/login</a></p>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/login.jpg" class="img-responsive"></p>
<h4 id="t274.5.3 &#x53D1;&#x8868;&#x6587;&#x7AE0;">4.5.3 &#x53D1;&#x8868;&#x6587;&#x7AE0; <a href="#t274.5.3 &#x53D1;&#x8868;&#x6587;&#x7AE0;"> # </a></h4>
<p><a href="http://localhost:3000/article/add">http://localhost:3000/article/add</a></p>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/articleadd.jpg" class="img-responsive"></p>
<h2 id="t285. &#x521D;&#x59CB;&#x5316;bower">5. &#x521D;&#x59CB;&#x5316;bower <a href="#t285. &#x521D;&#x59CB;&#x5316;bower"> # </a></h2>
<h3 id="t295.1 &#x5B89;&#x88C5;bower">5.1 &#x5B89;&#x88C5;bower <a href="#t295.1 &#x5B89;&#x88C5;bower"> # </a></h3>
<pre><code>$ npm install bower -g
</code></pre><h3 id="t305.2 &#x521D;&#x59CB;&#x5316;bower">5.2 &#x521D;&#x59CB;&#x5316;bower <a href="#t305.2 &#x521D;&#x59CB;&#x5316;bower"> # </a></h3>
<pre><code>bower init

E:\zhufengpeixunblog&gt;bower init
? name: zhufengpeixunblog
? version: 0.0.0
? description:
? main file:
? what types of modules does this package expose?
? keywords:
? authors: zhangrenyang-t510 &lt;zhang_renyang@&gt;
? license: MIT
? homepage:
? set currently installed components as dependencies? Yes
? add commonly ignored files to ignore list? Yes

{
  name: &apos;zhufengpeixunblog&apos;,
  version: &apos;0.0.0&apos;,
  authors: [
&apos;zhangrenyang-t510 &lt;zhang_renyang@&gt;&apos;
  ],
  license: &apos;MIT&apos;,
  ignore: [
&apos;**/.*&apos;,
&apos;node_modules&apos;,
&apos;bower_components&apos;,
&apos;test&apos;,
&apos;tests&apos;
  ]
}

? Looks good? Yes

&#x6267;&#x884C;&#x5B8C;&#x6B64;&#x547D;&#x4EE4;&#x540E;&#x4F1A;&#x751F;&#x6210;&#x4E00;&#x4E2A; `bower.json` &#x6587;&#x4EF6;&#x3002;
</code></pre><h3 id="t315.3  &#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6; .bowerrc">5.3  &#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6; .bowerrc <a href="#t315.3  &#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6; .bowerrc"> # </a></h3>
<p>&#x91CC;&#x9762;&#x5185;&#x5BB9;&#x5982;&#x4E0B;</p>
<pre><code>{&quot;directory&quot;:&quot;./public/lib&quot;}
</code></pre><blockquote>
<p>&#x8FD9;&#x8868;&#x793A;&#x4EE5;&#x540E;bower&#x5B89;&#x88C5;&#x7684;&#x6A21;&#x5757;&#x90FD;&#x5B89;&#x88C5;&#x5728;<code>./public/lib</code>&#x4E0B;&#x9762;</p>
</blockquote>
<h3 id="t325.4 &#x5B89;&#x88C5;bootstrap">5.4 &#x5B89;&#x88C5;bootstrap <a href="#t325.4 &#x5B89;&#x88C5;bootstrap"> # </a></h3>
<pre><code>$ bower install bootstrap --save
</code></pre><p>&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x4E0D;&#x4F46;&#x5B89;&#x88C5;&#x4E86;bootstrap,&#x4E5F;&#x5B89;&#x88C5;&#x4E86;&#x4F9D;&#x8D56;&#x7684;jquery</p>
<pre><code>E:\zhufengpeixunblog&gt;bower install bootstrap --save
bower bootstrap#~3.3.5 install bootstrap#3.3.5
bower jquery#&gt;= 1.9.1  install jquery#2.1.4
bootstrap#3.3.5 public\lib\bootstrap
&#x2514;&#x2500;&#x2500; jquery#2.1.4

jquery#2.1.4 public\lib\jquery
</code></pre><h2 id="t336. &#x5B8C;&#x5584;&#x9875;&#x9762;">6. &#x5B8C;&#x5584;&#x9875;&#x9762; <a href="#t336. &#x5B8C;&#x5584;&#x9875;&#x9762;"> # </a></h2>
<h3 id="t346.1 &#x521B;&#x5EFA;include&#x6587;&#x4EF6;&#x5939;">6.1 &#x521B;&#x5EFA;include&#x6587;&#x4EF6;&#x5939; <a href="#t346.1 &#x521B;&#x5EFA;include&#x6587;&#x4EF6;&#x5939;"> # </a></h3>
<p>&#x5728;views&#x4E0B;&#x521B;&#x5EFA;include&#x6587;&#x4EF6;&#x5939;</p>
<h3 id="t356.2 &#x521B;&#x5EFA; header.ejs">6.2 &#x521B;&#x5EFA; header.ejs <a href="#t356.2 &#x521B;&#x5EFA; header.ejs"> # </a></h3>
<p>&#x5728;include&#x4E0B;&#x6DFB;&#x52A0;&#x5305;&#x542B;&#x7684;&#x5934;&#x90E8;</p>
<pre><code class="lang-html"><span class="hljs-doctype">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span> <span class="hljs-attribute">lang</span>=<span class="hljs-value">&quot;zh-CN&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">charset</span>=<span class="hljs-value">&quot;utf-8&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">http-equiv</span>=<span class="hljs-value">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attribute">content</span>=<span class="hljs-value">&quot;IE=edge&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;viewport&quot;</span> <span class="hljs-attribute">content</span>=<span class="hljs-value">&quot;width=device-width, initial-scale=1&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>&#x73E0;&#x5CF0;&#x535A;&#x5BA2;<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">link</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/lib/bootstrap/dist/css/bootstrap.css&quot;</span> <span class="hljs-attribute">rel</span>=<span class="hljs-value">&quot;stylesheet&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-comment">&lt;!--&#x6700;&#x5916;&#x9762;&#x7684;&#x5BB9;&#x5668;nav&#x6807;&#x7B7E;&#xFF0C;&#x5E76;&#x6DFB;&#x52A0;nav-bar&#x6837;&#x5F0F;&#x7C7B;&#xFF0C;&#x8868;&#x793A;&#x8FD9;&#x91CC;&#x9762;&#x5C5E;&#x4E8E;&#x5BFC;&#x822A;&#x6761; --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">nav</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;navbar navbar-default&quot;</span> <span class="hljs-attribute">role</span>=<span class="hljs-value">&quot;navigation&quot;</span>&gt;</span>
<span class="hljs-comment">&lt;!--&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;&#x589E;&#x52A0;header--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;navbar-header&quot;</span>&gt;</span>
<span class="hljs-comment">&lt;!--&#x6700;&#x5DE6;&#x4FA7;&#x7684;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E0D;&#x53EF;&#x89C1; &#x6309;&#x94AE;&#x6807;&#x7B7E;&#x91CC;&#x5D4C;&#x5957;&#x4E86;&#x4E09;&#x4E2A;span&#x7684;icon&#x3002;
&#x7136;&#x540E;&#x7ED9;&#x4E0E;navbar-toggle&#x6837;&#x5F0F;&#x7C7B;&#x548C;&#x5C5E;&#x6027;collapse(&#x6536;&#x8D77;)&#xFF0C;
&#x70B9;&#x51FB;&#x7684;&#x65F6;&#x5019;&#x76EE;&#x6807;&#x4E3A;data-target&#x3002;&#x5F53;&#x7A97;&#x53E3;&#x7F29;&#x5C0F;&#x5230;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#xFF0C;&#x53F3;&#x4FA7;&#x7684;&#x6548;&#x679C;&#x663E;&#x73B0;&#x3002;--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;button&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;navbar-toggle&quot;</span>
<span class="hljs-attribute">data-toggle</span>=<span class="hljs-value">&quot;collapse&quot;</span> <span class="hljs-attribute">data-target</span>=<span class="hljs-value">&quot;#menus&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;sr-only&quot;</span>&gt;</span>&#x73E0;&#x5CF0;&#x535A;&#x5BA2;<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;icon-bar&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;icon-bar&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;icon-bar&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;navbar-brand&quot;</span>&gt;</span>&#x73E0;&#x5CF0;&#x535A;&#x5BA2;<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-comment">&lt;!-- &#x653E;&#x7F6E;&#x5176;&#x5B83;&#x7684;&#x5BFC;&#x822A;&#x6761; --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;collapse navbar-collapse&quot;</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;menus&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;nav navbar-nav&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;active&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/user/reg&quot;</span>&gt;</span>&#x6CE8;&#x518C;<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/user/login&quot;</span>&gt;</span>&#x767B;&#x5F55;<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/article/add&quot;</span>&gt;</span>&#x53D1;&#x8868;&#x6587;&#x7AE0;<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/user/logout&quot;</span>&gt;</span>&#x767B;&#x51FA;<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">nav</span>&gt;</span>
</code></pre>
<h3 id="t366.3 &#x521B;&#x5EFA; footer.ejs">6.3 &#x521B;&#x5EFA; footer.ejs <a href="#t366.3 &#x521B;&#x5EFA; footer.ejs"> # </a></h3>
<p>&#x5728;include&#x4E0B;&#x6DFB;&#x52A0;&#x5305;&#x542B;&#x7684;&#x5C3E;&#x90E8;</p>
<pre><code class="lang-javascript">&lt;script src=<span class="hljs-string">&quot;/lib/jquery/dist/jquery.js&quot;</span>&gt;<span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">&quot;/lib/bootstrap/dist/js/bootstrap.js&quot;</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
</span></code></pre>
<h3 id="t376.4 &#x4FEE;&#x6539;&#x9996;&#x9875;">6.4 &#x4FEE;&#x6539;&#x9996;&#x9875; <a href="#t376.4 &#x4FEE;&#x6539;&#x9996;&#x9875;"> # </a></h3>
<p>views/index.ejs</p>
<pre><code>&lt;% include include/header.ejs%&gt;
&lt;div class=&quot;container&quot;&gt;
 &#x4E3B;&#x9875;
&lt;/div&gt;
&lt;% include include/footer.ejs%&gt;
</code></pre><p>&#x6548;&#x679C;&#x5982;&#x4E0B;</p>
<p> <img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/homepage.jpg" class="img-responsive"></p>
<h3 id="t386.5 &#x4FEE;&#x6539;&#x7528;&#x6237;&#x6CE8;&#x518C;&#x9875;&#x9762;">6.5 &#x4FEE;&#x6539;&#x7528;&#x6237;&#x6CE8;&#x518C;&#x9875;&#x9762; <a href="#t386.5 &#x4FEE;&#x6539;&#x7528;&#x6237;&#x6CE8;&#x518C;&#x9875;&#x9762;"> # </a></h3>
<p>views/user/reg.ejs</p>
<pre><code class="lang-html">   <span class="hljs-tag">&lt;<span class="hljs-title">%</span> <span class="hljs-attribute">include</span> <span class="hljs-attribute">..</span>/<span class="hljs-attribute">include</span>/<span class="hljs-attribute">header.ejs</span>%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;container&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">action</span>=<span class="hljs-value">&quot;/user/reg&quot;</span> <span class="hljs-attribute">method</span>=<span class="hljs-value">&quot;post&quot;</span>  <span class="hljs-attribute">role</span>=<span class="hljs-value">&quot;form&quot;</span>
<span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-horizontal&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">&quot;username&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-2 control-label&quot;</span>&gt;</span>&#x7528;&#x6237;&#x540D;<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;input-group col-sm-10&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;input-group-addon&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;glyphicon glyphicon-user&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;text&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-control&quot;</span>
<span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;username&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;username&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;&#x7528;&#x6237;&#x540D;&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">&quot;email&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-2 control-label&quot;</span>&gt;</span>&#x90AE;&#x7BB1;<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;input-group col-sm-10&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;input-group-addon&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;glyphicon glyphicon-envelope&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;email&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-control&quot;</span>
<span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;email&quot;</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;email&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;&#x90AE;&#x7BB1;&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-2 control-label&quot;</span>&gt;</span>&#x5BC6;&#x7801;<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;input-group col-sm-10&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;input-group-addon&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;glyphicon glyphicon-lock&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-control&quot;</span>
<span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;&#x5BC6;&#x7801;&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">&quot;repassword&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-2 control-label&quot;</span>&gt;</span>&#x786E;&#x8BA4;&#x5BC6;&#x7801;<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;input-group col-sm-10&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;input-group-addon&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;glyphicon glyphicon-lock&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-control&quot;</span>
<span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;repassword&quot;</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;repassword&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;&#x786E;&#x8BA4;&#x5BC6;&#x7801;&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-offset-2 col-sm-10&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;submit&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;btn btn-default&quot;</span>&gt;</span>&#x63D0;&#x4EA4;<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;reset&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;btn btn-default&quot;</span>&gt;</span>&#x91CD;&#x7F6E;<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">%</span> <span class="hljs-attribute">include</span> <span class="hljs-attribute">..</span>/<span class="hljs-attribute">include</span>/<span class="hljs-attribute">footer.ejs</span>%&gt;</span>
</code></pre>
<p>&#x6548;&#x679C;&#x5982;&#x4E0B;
<img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/bootreg.jpg" class="img-responsive"></p>
<h3 id="t396.6 &#x4FEE;&#x6539;&#x7528;&#x6237;&#x767B;&#x5F55;&#x754C;&#x9762;">6.6 &#x4FEE;&#x6539;&#x7528;&#x6237;&#x767B;&#x5F55;&#x754C;&#x9762; <a href="#t396.6 &#x4FEE;&#x6539;&#x7528;&#x6237;&#x767B;&#x5F55;&#x754C;&#x9762;"> # </a></h3>
<p>views/user/login.ejs</p>
<pre><code class="lang-html">   <span class="hljs-tag">&lt;<span class="hljs-title">%</span> <span class="hljs-attribute">include</span> <span class="hljs-attribute">..</span>/<span class="hljs-attribute">include</span>/<span class="hljs-attribute">header.ejs</span>%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;container&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">action</span>=<span class="hljs-value">&quot;/user/login&quot;</span> <span class="hljs-attribute">method</span>=<span class="hljs-value">&quot;post&quot;</span>
 <span class="hljs-attribute">role</span>=<span class="hljs-value">&quot;form&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-horizontal&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">&quot;username&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-2 control-label&quot;</span>&gt;</span>&#x7528;&#x6237;&#x540D;<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;input-group col-sm-10&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;input-group-addon&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;glyphicon glyphicon-user&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;text&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-control&quot;</span>
 <span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;username&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;username&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;&#x7528;&#x6237;&#x540D;&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-2 control-label&quot;</span>&gt;</span>
&#x5BC6;&#x7801;<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;input-group col-sm-10&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;input-group-addon&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;glyphicon glyphicon-lock&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-control&quot;</span>
<span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;&#x5BC6;&#x7801;&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-offset-2 col-sm-10&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;submit&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;btn btn-default&quot;</span>&gt;</span>&#x63D0;&#x4EA4;<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;reset&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;btn btn-default&quot;</span>&gt;</span>&#x91CD;&#x7F6E;<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">%</span> <span class="hljs-attribute">include</span> <span class="hljs-attribute">..</span>/<span class="hljs-attribute">include</span>/<span class="hljs-attribute">footer.ejs</span>%&gt;</span>
</code></pre>
<p>&#x6548;&#x679C;&#x5982;&#x4E0B;
<img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/bootlogin.jpg" class="img-responsive"></p>
<h3 id="t406.7 &#x4FEE;&#x6539;&#x53D1;&#x8868;&#x6587;&#x7AE0;&#x9875;&#x9762;">6.7 &#x4FEE;&#x6539;&#x53D1;&#x8868;&#x6587;&#x7AE0;&#x9875;&#x9762; <a href="#t406.7 &#x4FEE;&#x6539;&#x53D1;&#x8868;&#x6587;&#x7AE0;&#x9875;&#x9762;"> # </a></h3>
<p>views/article/add.ejs</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">%</span> <span class="hljs-attribute">include</span> <span class="hljs-attribute">..</span>/<span class="hljs-attribute">include</span>/<span class="hljs-attribute">header.ejs</span>%&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;container&quot;</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">action</span>=<span class="hljs-value">&quot;/article/add&quot;</span> <span class="hljs-attribute">method</span>=<span class="hljs-value">&quot;post&quot;</span>
<span class="hljs-attribute">role</span>=<span class="hljs-value">&quot;form&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-horizontal&quot;</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">&quot;title&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-2 control-label&quot;</span>&gt;</span>&#x6807;&#x9898;<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-10&quot;</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;text&quot;</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">&quot;&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-control&quot;</span>
 <span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;title&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;title&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;&#x6807;&#x9898;&quot;</span>/&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">&quot;content&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-2 control-label&quot;</span>&gt;</span>&#x6B63;&#x6587;<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-10&quot;</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">textarea</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-control&quot;</span>   <span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;&quot;</span> <span class="hljs-attribute">cols</span>=<span class="hljs-value">&quot;30&quot;</span> <span class="hljs-attribute">rows</span>=<span class="hljs-value">&quot;10&quot;</span>
<span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;content&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;content&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;&#x8BF7;&#x8F93;&#x5165;&#x5185;&#x5BB9;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">textarea</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-offset-2 col-sm-10&quot;</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;submit&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;btn btn-default&quot;</span>&gt;</span>&#x63D0;&#x4EA4;<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;reset&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;btn btn-default&quot;</span>&gt;</span>&#x91CD;&#x7F6E;<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">%</span> <span class="hljs-attribute">include</span> <span class="hljs-attribute">..</span>/<span class="hljs-attribute">include</span>/<span class="hljs-attribute">footer.ejs</span>%&gt;</span>
</code></pre>
<p>&#x6548;&#x679C;&#x5982;&#x4E0B;</p>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/bootaddblog.jpg" class="img-responsive"></p>
<h2 id="t417.  &#x8FDE;&#x63A5;&#x6570;&#x636E;&#x5E93;">7.  &#x8FDE;&#x63A5;&#x6570;&#x636E;&#x5E93; <a href="#t417.  &#x8FDE;&#x63A5;&#x6570;&#x636E;&#x5E93;"> # </a></h2>
<h3 id="t427.1 &#x5B89;&#x88C5;&#x6570;&#x636E;&#x5E93;&#x652F;&#x6301;">7.1 &#x5B89;&#x88C5;&#x6570;&#x636E;&#x5E93;&#x652F;&#x6301; <a href="#t427.1 &#x5B89;&#x88C5;&#x6570;&#x636E;&#x5E93;&#x652F;&#x6301;"> # </a></h3>
<p>&#x5B89;&#x88C5;mongodb&#x6A21;&#x5757;&#x5230;node_modules&#x4E0B;&#x9762;&#x5E76;&#x628A;&#x6B64;&#x914D;&#x7F6E;&#x6DFB;&#x52A0;&#x5230;<code>package.json</code>&#x6587;&#x4EF6;&#x4E2D;</p>
<pre><code>$ npm install mongoose --save
</code></pre><h3 id="t437.2 &#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;">7.2 &#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6; <a href="#t437.2 &#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;"> # </a></h3>
<p>&#x5728;&#x5DE5;&#x7A0B;&#x6839;&#x76EE;&#x5F55;&#x4E0B;&#x521B;&#x5EFA; <code>settings.js</code> &#x6587;&#x4EF6;,&#x5185;&#x5BB9;&#x5982;&#x4E0B;</p>
<pre><code class="lang-javascript"><span class="hljs-built_in">module</span>.exports = {
cookieSecret:<span class="hljs-string">&apos;zhufengkey&apos;</span>, &#x7528;&#x4E8E; Cookie &#x52A0;&#x5BC6;&#x4E0E;&#x6570;&#x636E;&#x5E93;&#x65E0;&#x5173;
url:<span class="hljs-string">&quot;mongodb://123.57.143.189:27017/zhufengblog&quot;</span>
}
</code></pre>
<h3 id="t447.3 &#x521B;&#x5EFA;db&#x6587;&#x4EF6;&#x5939;">7.3 &#x521B;&#x5EFA;db&#x6587;&#x4EF6;&#x5939; <a href="#t447.3 &#x521B;&#x5EFA;db&#x6587;&#x4EF6;&#x5939;"> # </a></h3>
<p>&#x5728;db&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x521B;&#x5EFA;&#x6587;&#x4EF6;<code>index.js</code>,&#x6B64;&#x6587;&#x4EF6;&#x5B58;&#x653E;&#x7740;&#x6240;&#x6709;&#x7684;&#x6A21;&#x578B;
&#x6B64;&#x6587;&#x4EF6;&#x8D1F;&#x8D23;&#x5411;&#x5916;&#x66B4;&#x9732;&#x6A21;&#x578B;,&#x56E0;&#x4E3A;Model&#x8D4B;&#x7ED9;&#x4E86;global&#x4F5C;&#x4E3A;&#x5C5E;&#x6027;&#xFF0C;&#x90A3;&#x5C31;&#x610F;&#x5473;&#x7740;&#x53EA;&#x9700;&#x8981;&#x5F15;&#x5165;&#x4E00;&#x6B21;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x7A0B;&#x5E8F;&#x4EFB;&#x4F55;&#x5730;&#x65B9;&#x90FD;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x4E86;</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;mongoose&apos;</span>),
Schema = mongoose.Schema,
models = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./models&apos;</span>);
<span class="hljs-keyword">var</span> settings = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;../settings&apos;</span>);
mongoose.connect(settings.url);
mongoose.model(<span class="hljs-string">&apos;User&apos;</span>, <span class="hljs-keyword">new</span> Schema({
  username:{type:<span class="hljs-built_in">String</span>,required:<span class="hljs-literal">true</span>},&#x7528;&#x6237;&#x540D;
  password:{type:<span class="hljs-built_in">String</span>,required:<span class="hljs-literal">true</span>},&#x5BC6;&#x7801;
  email:{type:<span class="hljs-built_in">String</span>,required:<span class="hljs-literal">true</span>},&#x90AE;&#x7BB1;
  avatar:{type:<span class="hljs-built_in">String</span>,required:<span class="hljs-literal">true</span>}&#x5934;&#x50CF;
}));
mongoose.model(<span class="hljs-string">&apos;Article&apos;</span>, <span class="hljs-keyword">new</span> Schema( {
  user:{type:ObjectId,ref:<span class="hljs-string">&apos;User&apos;</span>}, &#x7528;&#x6237;
  title: <span class="hljs-built_in">String</span>, &#x6807;&#x9898;
  content: <span class="hljs-built_in">String</span>, &#x5185;&#x5BB9;
  createAt:{type: <span class="hljs-built_in">Date</span>, <span class="hljs-keyword">default</span>: <span class="hljs-built_in">Date</span>.now()} &#x521B;&#x5EFA;&#x65F6;&#x95F4;
}));
global.Model = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">modelName</span>) </span>{
 <span class="hljs-keyword">return</span> mongoose.model(modelName);
}
</code></pre>
<h3 id="t457.4 &#x5728;app.js&#x4E2D;&#x5F15;&#x5165;&#x6B64;&#x6A21;&#x5757;">7.4 &#x5728;app.js&#x4E2D;&#x5F15;&#x5165;&#x6B64;&#x6A21;&#x5757; <a href="#t457.4 &#x5728;app.js&#x4E2D;&#x5F15;&#x5165;&#x6B64;&#x6A21;&#x5757;"> # </a></h3>
<pre><code class="lang-javascript">  <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./db&apos;</span>); <span class="hljs-comment">//&#x5BFC;&#x5165;db&#x6A21;&#x5757;</span>
</code></pre>
<h2 id="t468. &#x4F1A;&#x8BDD;&#x652F;&#x6301;">8. &#x4F1A;&#x8BDD;&#x652F;&#x6301; <a href="#t468. &#x4F1A;&#x8BDD;&#x652F;&#x6301;"> # </a></h2>
<h3 id="t478.1 &#x5B89;&#x88C5;&#x4F1A;&#x8BDD;&#x652F;&#x6301;&#x6A21;&#x5757;">8.1 &#x5B89;&#x88C5;&#x4F1A;&#x8BDD;&#x652F;&#x6301;&#x6A21;&#x5757; <a href="#t478.1 &#x5B89;&#x88C5;&#x4F1A;&#x8BDD;&#x652F;&#x6301;&#x6A21;&#x5757;"> # </a></h3>
<p>&#x4F7F;&#x7528; <code>express-session</code> &#x548C; <code>connect-mongo</code> &#x6A21;&#x5757;&#x5B9E;&#x73B0;&#x4E86;&#x5C06;&#x4F1A;&#x8BDD;&#x4FE1;&#x606F;&#x5B58;&#x50A8;&#x5230;<code>mongodb</code>&#x4E2D;&#x3002;</p>
<pre><code>$ npm install express-session --save
$ npm install connect-mongo --save
</code></pre><h3 id="t488.2 &#x4FEE;&#x6539;app.js">8.2 &#x4FEE;&#x6539;app.js <a href="#t488.2 &#x4FEE;&#x6539;app.js"> # </a></h3>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> settings = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./settings&apos;</span>);
<span class="hljs-keyword">var</span> session = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;express-session&apos;</span>);
<span class="hljs-keyword">var</span> MongoStore = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;connect-mongo&apos;</span>)(session);
app.use(session({
  secret: settings.cookieSecret,<span class="hljs-comment">//secret &#x7528;&#x6765;&#x9632;&#x6B62;&#x7BE1;&#x6539; cookie</span>
  key: settings.db,<span class="hljs-comment">//key &#x7684;&#x503C;&#x4E3A; cookie &#x7684;&#x540D;&#x5B57;</span>
  <span class="hljs-comment">//&#x8BBE;&#x5B9A; cookie &#x7684;&#x751F;&#x5B58;&#x671F;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x8BBE;&#x7F6E; cookie &#x7684;&#x751F;&#x5B58;&#x671F;&#x4E3A; 30 &#x5929;</span>
  cookie: {maxAge: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">24</span> * <span class="hljs-number">30</span>},
  resave:<span class="hljs-literal">true</span>,
  saveUninitialized:<span class="hljs-literal">true</span>,
 <span class="hljs-comment">//&#x8BBE;&#x7F6E;&#x5B83;&#x7684; store &#x53C2;&#x6570;&#x4E3A; MongoStore &#x5B9E;&#x4F8B;&#xFF0C;&#x628A;&#x4F1A;&#x8BDD;&#x4FE1;&#x606F;&#x5B58;&#x50A8;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#xFF0C;</span>
 <span class="hljs-comment">//&#x4EE5;&#x907F;&#x514D;&#x91CD;&#x542F;&#x670D;&#x52A1;&#x5668;&#x65F6;&#x4F1A;&#x8BDD;&#x4E22;&#x5931;</span>
  store: <span class="hljs-keyword">new</span> MongoStore({
    db: settings.db,
    host: settings.host,
    port: settings.port,
  })
}));
</code></pre>
<p>&#x6DFB;&#x52A0;&#x5B8C;&#x4E86;&#x4EE5;&#x540E;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x8DEF;&#x7531;&#x4E2D;&#x901A;&#x8FC7;<code>request.session</code>&#x6765;&#x64CD;&#x4F5C;&#x4F1A;&#x8BDD;&#x5BF9;&#x8C61;&#x4E86;</p>
<h2 id="t499. &#x7528;&#x6237;&#x6CE8;&#x518C;&#x767B;&#x9646;">9. &#x7528;&#x6237;&#x6CE8;&#x518C;&#x767B;&#x9646; <a href="#t499. &#x7528;&#x6237;&#x6CE8;&#x518C;&#x767B;&#x9646;"> # </a></h2>
<h3 id="t509.1 &#x589E;&#x52A0;&#x5DE5;&#x5177;&#x65B9;&#x6CD5;">9.1 &#x589E;&#x52A0;&#x5DE5;&#x5177;&#x65B9;&#x6CD5; <a href="#t509.1 &#x589E;&#x52A0;&#x5DE5;&#x5177;&#x65B9;&#x6CD5;"> # </a></h3>
<p>&#x5728;<code>routes/users.js</code>&#x4E2D;&#x589E;&#x52A0;md5&#x52A0;&#x5BC6;&#x7684;&#x5DE5;&#x5177;&#x65B9;&#x6CD5;</p>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">md5</span>(<span class="hljs-params">val</span>)</span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;crypto&apos;</span>).createHash(<span class="hljs-string">&apos;md5&apos;</span>).update(val).digest(<span class="hljs-string">&apos;hex&apos;</span>);
}
</code></pre>
<h3 id="t519.2 &#x7528;&#x6237;&#x6CE8;&#x518C;&#x8DEF;&#x7531;">9.2 &#x7528;&#x6237;&#x6CE8;&#x518C;&#x8DEF;&#x7531; <a href="#t519.2 &#x7528;&#x6237;&#x6CE8;&#x518C;&#x8DEF;&#x7531;"> # </a></h3>
<p>&#x6CE8;&#x518C;&#x8868;&#x5355;&#x7684;form&#x4E2D;<code>action=&quot;/user/reg&quot;</code>,&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8981;&#x5B9E;&#x73B0;&#x7528;&#x6237;&#x6CE8;&#x518C;&#x7684;&#x8DEF;&#x7531;
&#x4FEE;&#x6539; <code>routes/users.js</code></p>
<pre><code class="lang-javascript">router.post(<span class="hljs-string">&apos;/reg&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
  <span class="hljs-comment">//&#x5C31;&#x662F; POST &#x8BF7;&#x6C42;&#x4FE1;&#x606F;&#x89E3;&#x6790;&#x8FC7;&#x540E;&#x7684;&#x5BF9;&#x8C61;</span>
  <span class="hljs-keyword">var</span> user = req.body;<span class="hljs-comment">//</span>
  <span class="hljs-keyword">if</span>(user.password != user.repassword){
      req.flash(<span class="hljs-string">&apos;error&apos;</span>,<span class="hljs-string">&apos;&#x4E24;&#x6B21;&#x8F93;&#x5165;&#x7684;&#x5BC6;&#x7801;&#x4E0D;&#x4E00;&#x81F4;&apos;</span>);
      <span class="hljs-keyword">return</span> res.redirect(<span class="hljs-string">&apos;/user/reg&apos;</span>);
  }
  <span class="hljs-comment">//&#x7531;&#x4E8E;repassword&#x4E0D;&#x9700;&#x8981;&#x4FDD;&#x5B58;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x5220;&#x9664;</span>
  <span class="hljs-keyword">delete</span> user.repassword;
  <span class="hljs-comment">//&#x5BF9;&#x5BC6;&#x7801;&#x8FDB;&#x884C;md5&#x52A0;&#x5BC6;</span>
  user.password = md5(user.password);
 <span class="hljs-comment">//&#x5F97;&#x5230;&#x7528;&#x6237;&#x7684;&#x5934;&#x50CF;</span>
  user.avatar = <span class="hljs-string">&quot;https://secure.gravatar.com/avatar/&quot;</span>
+md5(user.email)+<span class="hljs-string">&quot;?s=48&quot;</span>;
  <span class="hljs-keyword">new</span> Model(<span class="hljs-string">&apos;User&apos;</span>)(user).save(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,user</span>)</span>{
    <span class="hljs-keyword">if</span>(err){
      req.flash(<span class="hljs-string">&apos;error&apos;</span>,err);
      <span class="hljs-keyword">return</span> res.redirect(<span class="hljs-string">&apos;/user/reg&apos;</span>);
  }
  <span class="hljs-comment">//&#x7528;&#x6237;&#x4FE1;&#x606F;&#x5B58;&#x5165; session</span>
  req.session.user = user;
  <span class="hljs-comment">//&#x6CE8;&#x518C;&#x6210;&#x529F;&#x540E;&#x8FD4;&#x56DE;&#x4E3B;&#x9875;</span>
  res.redirect(<span class="hljs-string">&apos;/&apos;</span>);
  });
});
</code></pre>
<h3 id="t529.3 &#x7528;&#x6237;&#x767B;&#x9646;&#x8DEF;&#x7531;">9.3 &#x7528;&#x6237;&#x767B;&#x9646;&#x8DEF;&#x7531; <a href="#t529.3 &#x7528;&#x6237;&#x767B;&#x9646;&#x8DEF;&#x7531;"> # </a></h3>
<pre><code class="lang-javascript">router.post(<span class="hljs-string">&apos;/login&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
  <span class="hljs-keyword">var</span> user = req.body;
  user.password = md5(user.password);
  Model(<span class="hljs-string">&apos;User&apos;</span>).findOne(user,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,user</span>)</span>{
     <span class="hljs-keyword">if</span>(err){
       req.flash(<span class="hljs-string">&apos;error&apos;</span>,err);
       <span class="hljs-keyword">return</span> res.redirect(<span class="hljs-string">&apos;/user/login&apos;</span>);
     }
    req.session.user = user;<span class="hljs-comment">//&#x7528;&#x6237;&#x4FE1;&#x606F;&#x5B58;&#x5165; session</span>
    res.redirect(<span class="hljs-string">&apos;/&apos;</span>);<span class="hljs-comment">//&#x6CE8;&#x518C;&#x6210;&#x529F;&#x540E;&#x8FD4;&#x56DE;&#x4E3B;&#x9875;</span>
  });
});
</code></pre>
<h3 id="t539.4 &#x7528;&#x6237;&#x9000;&#x51FA;&#x8DEF;&#x7531;">9.4 &#x7528;&#x6237;&#x9000;&#x51FA;&#x8DEF;&#x7531; <a href="#t539.4 &#x7528;&#x6237;&#x9000;&#x51FA;&#x8DEF;&#x7531;"> # </a></h3>
<pre><code class="lang-javascript">router.get(<span class="hljs-string">&apos;/logout&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
  req.session.user = <span class="hljs-literal">null</span>;<span class="hljs-comment">//&#x7528;&#x6237;&#x4FE1;&#x606F;&#x5B58;&#x5165; session</span>
  res.redirect(<span class="hljs-string">&apos;/&apos;</span>);<span class="hljs-comment">//&#x6CE8;&#x518C;&#x6210;&#x529F;&#x540E;&#x8FD4;&#x56DE;&#x4E3B;&#x9875;</span>
});
</code></pre>
<h2 id="t5410. &#x53D1;&#x8868;&#x6587;&#x7AE0;&#x8DEF;&#x7531;">10. &#x53D1;&#x8868;&#x6587;&#x7AE0;&#x8DEF;&#x7531; <a href="#t5410. &#x53D1;&#x8868;&#x6587;&#x7AE0;&#x8DEF;&#x7531;"> # </a></h2>
<p>&#x53D1;&#x8868;&#x6587;&#x7AE0;&#x8868;&#x5355;&#x7684;form&#x4E2D;<code>action=&quot;/article/add&quot;</code>,&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8981;&#x5B9E;&#x73B0;&#x53D1;&#x8868;&#x6587;&#x7AE0;&#x8DEF;&#x7531;
&#x4FEE;&#x6539; <code>routes/article.js</code> &#x4E2D;&#x7684; <code>post(&apos;/add&apos;)</code></p>
<pre><code class="lang-javascript">router.post(<span class="hljs-string">&apos;/add&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
  req.body.user = req.session.user._id;
  <span class="hljs-keyword">new</span> Model(<span class="hljs-string">&apos;Article&apos;</span>)(req.body).save(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,article</span>)</span>{
  <span class="hljs-keyword">if</span>(err){
     <span class="hljs-keyword">return</span> res.redirect(<span class="hljs-string">&apos;/article/add&apos;</span>);
   }
 <span class="hljs-comment">//&#x53D1;&#x8868;&#x6587;&#x7AE0;&#x6210;&#x529F;&#x540E;&#x8FD4;&#x56DE;&#x4E3B;&#x9875;</span>
  res.redirect(<span class="hljs-string">&apos;/&apos;</span>);
});
});
</code></pre>
<h2 id="t5511. &#x9875;&#x9762;&#x6D88;&#x606F;&#x901A;&#x77E5;">11. &#x9875;&#x9762;&#x6D88;&#x606F;&#x901A;&#x77E5; <a href="#t5511. &#x9875;&#x9762;&#x6D88;&#x606F;&#x901A;&#x77E5;"> # </a></h2>
<p>&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5F15;&#x5165; flash &#x6A21;&#x5757;&#x6765;&#x5B9E;&#x73B0;&#x9875;&#x9762;&#x901A;&#x77E5;&#xFF08;&#x5373;&#x6210;&#x529F;&#x4E0E;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#x7684;&#x663E;&#x793A;&#xFF09;&#x7684;&#x529F;&#x80FD;&#x3002;</p>
<h3 id="t5611.1 &#x4EC0;&#x4E48;&#x662F; flash?">11.1 &#x4EC0;&#x4E48;&#x662F; flash? <a href="#t5611.1 &#x4EC0;&#x4E48;&#x662F; flash?"> # </a></h3>
<p>&#x6211;&#x4EEC;&#x6240;&#x8BF4;&#x7684; flash &#x5373; connect-flash &#x6A21;&#x5757;&#xFF08;<a href="https://github.com/jaredhanson/connect-flash&#xFF09;&#xFF0C;flash">https://github.com/jaredhanson/connect-flash&#xFF09;&#xFF0C;flash</a> &#x662F;&#x4E00;&#x4E2A;&#x5728; session &#x4E2D;&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x4FE1;&#x606F;&#x7684;&#x7279;&#x5B9A;&#x533A;&#x57DF;&#x3002;&#x4FE1;&#x606F;&#x5199;&#x5165; flash &#xFF0C;&#x4E0B;&#x4E00;&#x6B21;&#x663E;&#x793A;&#x5B8C;&#x6BD5;&#x540E;&#x5373;&#x88AB;&#x6E05;&#x9664;&#x3002;&#x5178;&#x578B;&#x7684;&#x5E94;&#x7528;&#x662F;&#x7ED3;&#x5408;&#x91CD;&#x5B9A;&#x5411;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x786E;&#x4FDD;&#x4FE1;&#x606F;&#x662F;&#x63D0;&#x4F9B;&#x7ED9;&#x4E0B;&#x4E00;&#x4E2A;&#x88AB;&#x6E32;&#x67D3;&#x7684;&#x9875;&#x9762;&#x3002;</p>
<h3 id="t5711.2  &#x5B89;&#x88C5;&#x6A21;&#x5757;">11.2  &#x5B89;&#x88C5;&#x6A21;&#x5757; <a href="#t5711.2  &#x5B89;&#x88C5;&#x6A21;&#x5757;"> # </a></h3>
<pre><code>$ npm install connect-flash --save
</code></pre><h3 id="t5811.3  &#x5BFC;&#x5165;&#x6A21;&#x5757;">11.3  &#x5BFC;&#x5165;&#x6A21;&#x5757; <a href="#t5811.3  &#x5BFC;&#x5165;&#x6A21;&#x5757;"> # </a></h3>
<p>&#x5728;app.js&#x4E2D;&#x6DFB;&#x52A0;&#x8C03;&#x7528;&#x6B64;&#x6A21;&#x5757;</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> flash = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;connect-flash&apos;</span>);
app.use(flash());
</code></pre>
<h3 id="t5911.4 &#x53D1;&#x8868;&#x6587;&#x7AE0;&#x6210;&#x529F;&#x63D0;&#x793A;">11.4 &#x53D1;&#x8868;&#x6587;&#x7AE0;&#x6210;&#x529F;&#x63D0;&#x793A; <a href="#t5911.4 &#x53D1;&#x8868;&#x6587;&#x7AE0;&#x6210;&#x529F;&#x63D0;&#x793A;"> # </a></h3>
<p>&#x5728;&#x53D1;&#x8868;&#x6587;&#x7AE0;&#x7684;&#x8DEF;&#x7531;&#x91CC;&#x653E;&#x7F6E;flash&#x63D0;&#x793A;&#x4FE1;&#x606F;</p>
<pre><code class="lang-javascript">router.post(<span class="hljs-string">&apos;/add&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
  req.body.user = req.session.user._id;
  <span class="hljs-keyword">new</span> Model(<span class="hljs-string">&apos;Article&apos;</span>)(req.body).save(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,article</span>)</span>{
    <span class="hljs-keyword">if</span>(err){
       req.flash(<span class="hljs-string">&apos;error&apos;</span>, <span class="hljs-string">&apos;&#x66F4;&#x65B0;&#x6587;&#x7AE0;&#x5931;&#x8D25;!&apos;</span>); <span class="hljs-comment">//&#x653E;&#x7F6E;&#x5931;&#x8D25;&#x4FE1;&#x606F;</span>
       <span class="hljs-keyword">return</span> res.redirect(<span class="hljs-string">&apos;/article/add&apos;</span>);
    }
    req.flash(<span class="hljs-string">&apos;success&apos;</span>, <span class="hljs-string">&apos;&#x66F4;&#x65B0;&#x6587;&#x7AE0;&#x6210;&#x529F;!&apos;</span>);  <span class="hljs-comment">//&#x653E;&#x7F6E;&#x6210;&#x529F;&#x4FE1;&#x606F;</span>
    res.redirect(<span class="hljs-string">&apos;/&apos;</span>);<span class="hljs-comment">//&#x53D1;&#x8868;&#x6587;&#x7AE0;&#x6210;&#x529F;&#x540E;&#x8FD4;&#x56DE;&#x4E3B;&#x9875;</span>
  });
});
</code></pre>
<h3 id="t6011.5 &#x589E;&#x52A0;&#x663E;&#x793A;&#x63D0;&#x793A;&#x7684;&#x533A;&#x57DF;">11.5 &#x589E;&#x52A0;&#x663E;&#x793A;&#x63D0;&#x793A;&#x7684;&#x533A;&#x57DF; <a href="#t6011.5 &#x589E;&#x52A0;&#x663E;&#x793A;&#x63D0;&#x793A;&#x7684;&#x533A;&#x57DF;"> # </a></h3>
<p>&#x4FEE;&#x6539; views/include/header.ejs
&#x5728;&#x6700;&#x5E95;&#x90E8;&#x589E;&#x52A0;&#x4EE5;&#x4E0B;&#x533A;&#x57DF;</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;container text-center&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">%</span> <span class="hljs-attribute">if</span> (<span class="hljs-attribute">success</span>) { %&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;alert alert-success&quot;</span> <span class="hljs-attribute">role</span>=<span class="hljs-value">&quot;alert&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">%=</span> <span class="hljs-attribute">success</span> %&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">%</span> } %&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">%</span> <span class="hljs-attribute">if</span> (<span class="hljs-attribute">error</span>) { %&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;alert alert-danger&quot;</span> <span class="hljs-attribute">role</span>=<span class="hljs-value">&quot;alert&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">%=</span> <span class="hljs-attribute">error</span> %&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">%</span> } %&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<h3 id="t6111.6  &#x8BBE;&#x7F6E;&#x6A21;&#x677F;&#x9ED8;&#x8BA4;&#x503C;">11.6  &#x8BBE;&#x7F6E;&#x6A21;&#x677F;&#x9ED8;&#x8BA4;&#x503C; <a href="#t6111.6  &#x8BBE;&#x7F6E;&#x6A21;&#x677F;&#x9ED8;&#x8BA4;&#x503C;"> # </a></h3>
<p>&#x5728;app.js &#x4E2D;&#x589E;&#x52A0;&#x4EE5;&#x4E0B;&#x4E2D;&#x95F4;&#x4EF6;</p>
<pre><code class="lang-javascript">app.use(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req,res,next</span>)</span>{
  res.locals.user = req.session.user;
  res.locals.success = req.flash(<span class="hljs-string">&apos;success&apos;</span>).toString();
  res.locals.error = req.flash(<span class="hljs-string">&apos;error&apos;</span>).toString();
  next();
});
</code></pre>
<h2 id="t6212. &#x63A7;&#x5236;&#x5BFC;&#x822A;">12. &#x63A7;&#x5236;&#x5BFC;&#x822A; <a href="#t6212. &#x63A7;&#x5236;&#x5BFC;&#x822A;"> # </a></h2>
<p>&#x7528;&#x6237;&#x662F;&#x5426;&#x767B;&#x9646;&#x770B;&#x5230;&#x7684;&#x9875;&#x9762;&#x5E94;&#x8BE5;&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5E94;&#x8BE5;&#x6839;&#x636E;&#x7528;&#x6237;&#x767B;&#x9646;&#x72B6;&#x6001;&#x6765;&#x63A7;&#x5236;&#x5BFC;&#x822A;&#x83DC;&#x5355;&#x7684;&#x663E;&#x793A;&#x72B6;&#x6001;
&#x4FEE;&#x6539; <code>views/include/header.ejs</code></p>
<pre><code class="lang-javascript">&lt;ul <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;nav navbar-nav&quot;</span>&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">%</span>
  <span class="hljs-attribute">if</span>(!<span class="hljs-attribute">user</span>){%&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;active&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/user/reg&quot;</span>&gt;</span>&#x6CE8;&#x518C;<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/user/login&quot;</span>&gt;</span>&#x767B;&#x5F55;<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">%}else{</span>
  %&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/article/add&quot;</span>&gt;</span>&#x53D1;&#x8868;&#x6587;&#x7AE0;<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/user/logout&quot;</span>&gt;</span>&#x767B;&#x51FA;<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">%}%</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
</span></code></pre>
<p>&#x7528;&#x6237;&#x767B;&#x9646;&#x540E;&#x663E;&#x793A;&#x53D1;&#x8868;&#x6587;&#x7AE0;&#x548C;&#x767B;&#x51FA;&#x6309;&#x94AE;&#xFF0C;&#x7528;&#x6237;&#x767B;&#x9646;&#x524D;&#x663E;&#x793A;&#x6CE8;&#x518C;&#x548C;&#x767B;&#x5F55;&#x6309;&#x94AE;&#x3002;</p>
<h2 id="t6313 &#x9875;&#x9762;&#x6743;&#x9650;&#x63A7;&#x5236;">13 &#x9875;&#x9762;&#x6743;&#x9650;&#x63A7;&#x5236; <a href="#t6313 &#x9875;&#x9762;&#x6743;&#x9650;&#x63A7;&#x5236;"> # </a></h2>
<p>&#x6211;&#x4EEC;&#x867D;&#x7136;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x4E86;&#x7528;&#x6237;&#x6CE8;&#x518C;&#x4E0E;&#x767B;&#x9646;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x4F46;&#x5E76;&#x4E0D;&#x80FD;&#x963B;&#x6B62;&#x6BD4;&#x5982;&#x5DF2;&#x7ECF;&#x767B;&#x9646;&#x7684;&#x7528;&#x6237;&#x8BBF;&#x95EE; <a href="http://localhost:3000/user/reg">http://localhost:3000/user/reg</a> &#x9875;&#x9762;
&#x4E3A;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E3A;&#x9875;&#x9762;&#x8BBE;&#x7F6E;&#x8BBF;&#x95EE;&#x6743;&#x9650;&#x3002;&#x5373;&#x6CE8;&#x518C;&#x548C;&#x767B;&#x9646;&#x9875;&#x9762;&#x5E94;&#x8BE5;&#x963B;&#x6B62;&#x5DF2;&#x767B;&#x9646;&#x7684;&#x7528;&#x6237;&#x8BBF;&#x95EE;
&#x767B;&#x51FA;&#x53CA;&#x540E;&#x9762;&#x6211;&#x4EEC;&#x5C06;&#x8981;&#x5B9E;&#x73B0;&#x7684;&#x53D1;&#x8868;&#x9875;&#x53EA;&#x5BF9;&#x5DF2;&#x767B;&#x5F55;&#x7684;&#x7528;&#x6237;&#x5F00;&#x653E;
&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x9875;&#x9762;&#x6743;&#x9650;&#x7684;&#x63A7;&#x5236;&#x5462;&#xFF1F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x628A;&#x7528;&#x6237;&#x767B;&#x5F55;&#x72B6;&#x6001;&#x7684;&#x68C0;&#x67E5;&#x653E;&#x5230;&#x8DEF;&#x7531;&#x4E2D;&#x95F4;&#x4EF6;&#x4E2D;&#xFF0C;&#x5728;&#x6BCF;&#x4E2A;&#x8DEF;&#x5F84;&#x524D;&#x589E;&#x52A0;&#x8DEF;&#x7531;&#x4E2D;&#x95F4;&#x4EF6;&#xFF0C;&#x5373;&#x53EF;&#x5B9E;&#x73B0;&#x9875;&#x9762;&#x6743;&#x9650;&#x63A7;&#x5236;
&#x6211;&#x4EEC;&#x6DFB;&#x52A0;<code>checkNotLogin</code>&#x548C; <code>checkLogin</code>&#x51FD;&#x6570;&#x6765;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;</p>
<h3 id="t6413.1  &#x6DFB;&#x52A0;&#x4E2D;&#x95F4;&#x4EF6;">13.1  &#x6DFB;&#x52A0;&#x4E2D;&#x95F4;&#x4EF6; <a href="#t6413.1  &#x6DFB;&#x52A0;&#x4E2D;&#x95F4;&#x4EF6;"> # </a></h3>
<p>&#x6DFB;&#x52A0;middleware&#x6587;&#x4EF6;&#x5939;
&#x5728;<code>middleware</code>&#x4E0B;&#x6DFB;&#x52A0;<code>index.js</code>&#x6587;&#x4EF6;
middleware/index.js</p>
<pre><code class="lang-javascript">exports.checkLogin = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>) </span>{
 <span class="hljs-keyword">if</span> (!req.session.user) {
   req.flash(<span class="hljs-string">&apos;error&apos;</span>, <span class="hljs-string">&apos;&#x672A;&#x767B;&#x5F55;!&apos;</span>);
   <span class="hljs-keyword">return</span> res.redirect(<span class="hljs-string">&apos;/user/login&apos;</span>);
 }
 next();
}

exports.checkNotLogin = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>) </span>{
 <span class="hljs-keyword">if</span> (req.session.user) {
   req.flash(<span class="hljs-string">&apos;error&apos;</span>, <span class="hljs-string">&apos;&#x5DF2;&#x767B;&#x5F55;!&apos;</span>);
   <span class="hljs-keyword">return</span> res.redirect(<span class="hljs-string">&apos;back&apos;</span>);<span class="hljs-comment">//&#x8FD4;&#x56DE;&#x4E4B;&#x524D;&#x7684;&#x9875;&#x9762;</span>
 }
 next();
}
</code></pre>
<h3 id="t6513.2   &#x5728;&#x8DEF;&#x7531;&#x4E2D;&#x6DFB;&#x52A0;&#x4E2D;&#x95F4;&#x4EF6;">13.2   &#x5728;&#x8DEF;&#x7531;&#x4E2D;&#x6DFB;&#x52A0;&#x4E2D;&#x95F4;&#x4EF6; <a href="#t6513.2   &#x5728;&#x8DEF;&#x7531;&#x4E2D;&#x6DFB;&#x52A0;&#x4E2D;&#x95F4;&#x4EF6;"> # </a></h3>
<p>&#x4FEE;&#x6539; routes/users.js</p>
<pre><code class="lang-javascript">router.get(<span class="hljs-string">&apos;/reg&apos;</span>,middleware.checkNotLogin, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
  res.render(<span class="hljs-string">&apos;user/reg&apos;</span>, {title: <span class="hljs-string">&apos;&#x6CE8;&#x518C;&apos;</span>});
});
</code></pre>
<p>&#x4FEE;&#x6539;routes/article.js</p>
<pre><code class="lang-javascript">router.get(<span class="hljs-string">&apos;/add&apos;</span>,middleware.checkLogin, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
  res.render(<span class="hljs-string">&apos;article/add&apos;</span>, { title: <span class="hljs-string">&apos;&#x53D1;&#x8868;&#x6587;&#x7AE0;&apos;</span> });
});
</code></pre>
<p>&#x51E1;&#x662F;&#x4E0D;&#x80FD;&#x767B;&#x9646;&#x7684;&#x4E2D;&#x95F4;&#x52A0;&#x5165; <code>checkNotLogin</code>
&#x51E1;&#x662F;&#x9700;&#x8981;&#x767B;&#x9646;&#x7684;&#x4E2D;&#x95F4;&#x52A0;&#x5165; <code>checkLogin</code></p>
<h2 id="t6614 &#x663E;&#x793A;&#x6587;&#x7AE0;&#x5217;&#x8868;">14 &#x663E;&#x793A;&#x6587;&#x7AE0;&#x5217;&#x8868; <a href="#t6614 &#x663E;&#x793A;&#x6587;&#x7AE0;&#x5217;&#x8868;"> # </a></h2>
<h3 id="t6714.1 &#x4FEE;&#x6539;&#x9996;&#x9875;&#x6A21;&#x677F;">14.1 &#x4FEE;&#x6539;&#x9996;&#x9875;&#x6A21;&#x677F; <a href="#t6714.1 &#x4FEE;&#x6539;&#x9996;&#x9875;&#x6A21;&#x677F;"> # </a></h3>
<p>views/index.ejs</p>
<pre><code class="lang-html">   <span class="hljs-tag">&lt;<span class="hljs-title">%</span> <span class="hljs-attribute">include</span> <span class="hljs-attribute">include</span>/<span class="hljs-attribute">header.ejs</span>%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;container&quot;</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;media-list&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">%</span>
  <span class="hljs-attribute">articles.forEach</span>(<span class="hljs-attribute">function</span>(<span class="hljs-attribute">article</span>){
  %&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;media&quot;</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;media-left&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;#&quot;</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">img</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;media-object&quot;</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">&quot;&lt;%=article.user.avatar%&gt;&quot;</span> <span class="hljs-attribute">alt</span>=<span class="hljs-value">&quot;&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;media-body&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">h4</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;media-heading&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/article/detail/&lt;%=article._id%&gt;&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">%=article.title%</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">h4</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">p</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;media-left&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">%-</span> <span class="hljs-attribute">article.content</span>%&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;media-bottom&quot;</span>&gt;</span>
&#x4F5C;&#x8005;:<span class="hljs-tag">&lt;<span class="hljs-title">%=article.user.username%</span>&gt;</span>
&#x53D1;&#x8868;&#x65F6;&#x95F4;:<span class="hljs-tag">&lt;<span class="hljs-title">%=article.createAt.toLocaleString()%</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">%</span>
  });
  %&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">%</span> <span class="hljs-attribute">include</span> <span class="hljs-attribute">include</span>/<span class="hljs-attribute">footer.ejs</span>%&gt;</span>
</code></pre>
<h3 id="t6814.2 &#x4FEE;&#x6539;&#x8DEF;&#x7531;">14.2 &#x4FEE;&#x6539;&#x8DEF;&#x7531; <a href="#t6814.2 &#x4FEE;&#x6539;&#x8DEF;&#x7531;"> # </a></h3>
<p>routes/index.js</p>
<pre><code class="lang-javascript">router.get(<span class="hljs-string">&apos;/&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>) </span>{
  Model(<span class="hljs-string">&apos;Article&apos;</span>).find({}).populate(<span class="hljs-string">&apos;user&apos;</span>).exec(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,articles</span>)</span>{
     res.render(<span class="hljs-string">&apos;index&apos;</span>, {title: <span class="hljs-string">&apos;&#x4E3B;&#x9875;&apos;</span>,articles:articles});
  });
});
</code></pre>
<h2 id="t6915 &#x652F;&#x6301;markdown">15 &#x652F;&#x6301;markdown <a href="#t6915 &#x652F;&#x6301;markdown"> # </a></h2>
<h3 id="t7015.1 &#x5B89;&#x88C5;markdown">15.1 &#x5B89;&#x88C5;markdown <a href="#t7015.1 &#x5B89;&#x88C5;markdown"> # </a></h3>
<pre><code class="lang-javascript">$ npm install markdown -save
</code></pre>
<h3 id="t7115.2  &#x4FEE;&#x6539;&#x8DEF;&#x7531;">15.2  &#x4FEE;&#x6539;&#x8DEF;&#x7531; <a href="#t7115.2  &#x4FEE;&#x6539;&#x8DEF;&#x7531;"> # </a></h3>
<p>routes/index.js</p>
<pre><code class="lang-javascript">markdown = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;markdown&apos;</span>).markdown;

router.get(<span class="hljs-string">&apos;/&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>) </span>{
  Model(<span class="hljs-string">&apos;Article&apos;</span>).find({}).populate(<span class="hljs-string">&apos;user&apos;</span>).exec(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,articles</span>)</span>{
     articles.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">article</span>) </span>{
         article.content = markdown.toHTML(article.content);
    });
    res.render(<span class="hljs-string">&apos;index&apos;</span>, {title: <span class="hljs-string">&apos;&#x4E3B;&#x9875;&apos;</span>,articles:articles});
  });
});
</code></pre>
<h2 id="t7216 &#x6587;&#x7AE0;&#x8BE6;&#x60C5;&#x9875;">16 &#x6587;&#x7AE0;&#x8BE6;&#x60C5;&#x9875; <a href="#t7216 &#x6587;&#x7AE0;&#x8BE6;&#x60C5;&#x9875;"> # </a></h2>
<h3 id="t7316.1   &#x4FEE;&#x6539;&#x9996;&#x9875;">16.1   &#x4FEE;&#x6539;&#x9996;&#x9875; <a href="#t7316.1   &#x4FEE;&#x6539;&#x9996;&#x9875;"> # </a></h3>
<p>views/index.ejs</p>
<pre><code class="lang-javascript">&lt;h4 <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;media-heading&quot;</span>&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/article/detail/&lt;%=article._id%&gt;&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">%=article.title%</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">h4</span>&gt;</span>
</span></code></pre>
<h3 id="t7416.2 &#x4FEE;&#x6539;&#x8DEF;&#x7531;">16.2 &#x4FEE;&#x6539;&#x8DEF;&#x7531; <a href="#t7416.2 &#x4FEE;&#x6539;&#x8DEF;&#x7531;"> # </a></h3>
<p>routes/article.js</p>
<pre><code class="lang-javascript">router.get(<span class="hljs-string">&apos;/detail/:_id&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
 Model(<span class="hljs-string">&apos;Article&apos;</span>).findOne({_id:req.params._id},<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,article</span>)</span>{
   article.content = markdown.toHTML(article.content);
   res.render(<span class="hljs-string">&apos;article/detail&apos;</span>,{title:<span class="hljs-string">&apos;&#x67E5;&#x770B;&#x6587;&#x7AE0;&apos;</span>,article:article});
 });
});
</code></pre>
<h3 id="t7516.3 &#x589E;&#x52A0;&#x8BE6;&#x60C5;&#x9875;">16.3 &#x589E;&#x52A0;&#x8BE6;&#x60C5;&#x9875; <a href="#t7516.3 &#x589E;&#x52A0;&#x8BE6;&#x60C5;&#x9875;"> # </a></h3>
<p>views/article/detail.ejs</p>
<pre><code class="lang-javascript">&lt;% include ../include/header.ejs%&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;container&quot;</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;panel panel-default&quot;</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;panel-heading&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">%=article.title%</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;panel-body&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">%-article.content%</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;panel-footer&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/article/edit/&lt;%=article._id%&gt;&quot;</span>
         <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;btn btn-warning&quot;</span>&gt;</span>&#x7F16;&#x8F91;<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/article/delete/&lt;%=article._id%&gt;&quot;</span>
         <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;btn btn-danger&quot;</span>&gt;</span>&#x5220;&#x9664;<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">%</span> <span class="hljs-attribute">include</span> <span class="hljs-attribute">..</span>/<span class="hljs-attribute">include</span>/<span class="hljs-attribute">footer.ejs</span>%&gt;</span>
</span></code></pre>
<h2 id="t7617 &#x5220;&#x9664;&#x6587;&#x7AE0;">17 &#x5220;&#x9664;&#x6587;&#x7AE0; <a href="#t7617 &#x5220;&#x9664;&#x6587;&#x7AE0;"> # </a></h2>
<h3 id="t7717.1 &#x4FEE;&#x6539;&#x8BE6;&#x60C5;&#x9875;">17.1 &#x4FEE;&#x6539;&#x8BE6;&#x60C5;&#x9875; <a href="#t7717.1 &#x4FEE;&#x6539;&#x8BE6;&#x60C5;&#x9875;"> # </a></h3>
<p>views/article/detail.ejs</p>
<pre><code class="lang-html"> <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/article/delete/&lt;%=article._id%&gt;&quot;</span>
   <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;btn btn-danger&quot;</span>&gt;</span>&#x5220;&#x9664;<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
</code></pre>
<h3 id="t7817.2 &#x4FEE;&#x6539;&#x8DEF;&#x7531;">17.2 &#x4FEE;&#x6539;&#x8DEF;&#x7531; <a href="#t7817.2 &#x4FEE;&#x6539;&#x8DEF;&#x7531;"> # </a></h3>
<p> routes/article.js</p>
<pre><code class="lang-javascript">router.get(<span class="hljs-string">&apos;/delete/:_id&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
  Model(<span class="hljs-string">&apos;Article&apos;</span>).remove({_id:req.params._id},<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,result</span>)</span>{
    <span class="hljs-keyword">if</span>(err){
      req.flash(<span class="hljs-string">&apos;error&apos;</span>,err);
      res.redirect(<span class="hljs-string">&apos;back&apos;</span>);
    }
    req.flash(<span class="hljs-string">&apos;success&apos;</span>, <span class="hljs-string">&apos;&#x5220;&#x9664;&#x6587;&#x7AE0;&#x6210;&#x529F;!&apos;</span>);
    res.redirect(<span class="hljs-string">&apos;/&apos;</span>);<span class="hljs-comment">//&#x6CE8;&#x518C;&#x6210;&#x529F;&#x540E;&#x8FD4;&#x56DE;&#x4E3B;&#x9875;</span>
  });
});
</code></pre>
<h2 id="t7918 &#x7F16;&#x8F91;&#x6587;&#x7AE0;">18 &#x7F16;&#x8F91;&#x6587;&#x7AE0; <a href="#t7918 &#x7F16;&#x8F91;&#x6587;&#x7AE0;"> # </a></h2>
<h3 id="t8018.1 &#x4FEE;&#x6539;&#x8BE6;&#x60C5;&#x9875;">18.1 &#x4FEE;&#x6539;&#x8BE6;&#x60C5;&#x9875; <a href="#t8018.1 &#x4FEE;&#x6539;&#x8BE6;&#x60C5;&#x9875;"> # </a></h3>
<p>views/article/detail.ejs</p>
<pre><code class="lang-javascript">&lt;a href=&quot;/article/edit/&lt;%=article._id%&gt;&quot; class=&quot;btn btn-warning&quot;&gt;&#x7F16;&#x8F91;&lt;/a&gt;
</code></pre>
<h3 id="t8118.2 &#x4FEE;&#x6539;&#x6DFB;&#x52A0;&#x6587;&#x7AE0;&#x754C;&#x9762;">18.2 &#x4FEE;&#x6539;&#x6DFB;&#x52A0;&#x6587;&#x7AE0;&#x754C;&#x9762; <a href="#t8118.2 &#x4FEE;&#x6539;&#x6DFB;&#x52A0;&#x6587;&#x7AE0;&#x754C;&#x9762;"> # </a></h3>
<p>views/article/add.ejs</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">action</span>=<span class="hljs-value">&quot;/article/add&quot;</span> <span class="hljs-attribute">method</span>=<span class="hljs-value">&quot;post&quot;</span>  <span class="hljs-attribute">role</span>=<span class="hljs-value">&quot;form&quot;</span>
<span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-horizontal&quot;</span> <span class="hljs-attribute">enctype</span>=<span class="hljs-value">&quot;multipart/form-data&quot;</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;hidden&quot;</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">&quot;&lt;%=article._id%&gt;&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;_id&quot;</span>/&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">&quot;title&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-2 control-label&quot;</span>&gt;</span>&#x6807;&#x9898;<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-10&quot;</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;text&quot;</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">&quot;&lt;%=article.title%&gt;&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-control&quot;</span>
<span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;title&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;title&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;&#x6807;&#x9898;&quot;</span>/&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">&quot;content&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-2 control-label&quot;</span>&gt;</span>&#x6B63;&#x6587;<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-10&quot;</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">textarea</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-control&quot;</span>   <span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;&quot;</span> <span class="hljs-attribute">cols</span>=<span class="hljs-value">&quot;30&quot;</span> <span class="hljs-attribute">rows</span>=<span class="hljs-value">&quot;10&quot;</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;content&quot;</span>
<span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;content&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;&#x8BF7;&#x8F93;&#x5165;&#x5185;&#x5BB9;&quot;</span> &gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">%=article.content%</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">textarea</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">&quot;img&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-2 control-label&quot;</span>&gt;</span>&#x56FE;&#x7247;<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-10&quot;</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">%</span>
 <span class="hljs-attribute">if</span>(<span class="hljs-attribute">article.img</span>){
 %&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">img</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">&quot;&lt;%=article.img%&gt;&quot;</span> <span class="hljs-attribute">style</span>=<span class="hljs-value">&quot;width:100px;height:100px&quot;</span> <span class="hljs-attribute">alt</span>=<span class="hljs-value">&quot;&quot;</span>/&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">%</span>
 }
  %&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;file&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-control&quot;</span>  <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;img&quot;</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;img&quot;</span>/&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;col-sm-offset-2 col-sm-10&quot;</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;submit&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;btn btn-default&quot;</span>&gt;</span>&#x63D0;&#x4EA4;<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;reset&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;btn btn-default&quot;</span>&gt;</span>&#x91CD;&#x7F6E;<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
</code></pre>
<h3 id="t8218.3 &#x4FEE;&#x6539;&#x8DEF;&#x7531;">18.3 &#x4FEE;&#x6539;&#x8DEF;&#x7531; <a href="#t8218.3 &#x4FEE;&#x6539;&#x8DEF;&#x7531;"> # </a></h3>
<p>routes/article.js</p>
<pre><code class="lang-javascript">router.post(<span class="hljs-string">&apos;/add&apos;</span>,middleware.checkLogin,upload.single(<span class="hljs-string">&apos;img&apos;</span>),
 <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
  <span class="hljs-keyword">var</span> _id = req.body._id;
  <span class="hljs-keyword">if</span>(_id){
    <span class="hljs-keyword">var</span> set = {title:req.body.title,content:req.body.content};
    Model(<span class="hljs-string">&apos;Article&apos;</span>).update({_id:_id},{$set:set},<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,result</span>)</span>{
      <span class="hljs-keyword">if</span>(err){
        req.flash(<span class="hljs-string">&apos;error&apos;</span>,err);
        <span class="hljs-keyword">return</span> res.redirect(<span class="hljs-string">&apos;back&apos;</span>);
    }
    req.flash(<span class="hljs-string">&apos;success&apos;</span>, <span class="hljs-string">&apos;&#x66F4;&#x65B0;&#x6587;&#x7AE0;&#x6210;&#x529F;!&apos;</span>);
    res.redirect(<span class="hljs-string">&apos;/&apos;</span>);<span class="hljs-comment">//&#x6CE8;&#x518C;&#x6210;&#x529F;&#x540E;&#x8FD4;&#x56DE;&#x4E3B;&#x9875;</span>
    });
  }<span class="hljs-keyword">else</span>{
    req.body.user = req.session.user._id;
    <span class="hljs-keyword">new</span> Model(<span class="hljs-string">&apos;Article&apos;</span>)(req.body).save(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,article</span>)</span>{
    <span class="hljs-keyword">if</span>(err){
      req.flash(<span class="hljs-string">&apos;error&apos;</span>,err);
      <span class="hljs-keyword">return</span> res.redirect(<span class="hljs-string">&apos;/article/add&apos;</span>);
    }
    req.flash(<span class="hljs-string">&apos;success&apos;</span>, <span class="hljs-string">&apos;&#x53D1;&#x8868;&#x6587;&#x7AE0;&#x6210;&#x529F;!&apos;</span>);
    res.redirect(<span class="hljs-string">&apos;/&apos;</span>);<span class="hljs-comment">//&#x6CE8;&#x518C;&#x6210;&#x529F;&#x540E;&#x8FD4;&#x56DE;&#x4E3B;&#x9875;</span>
  });
  }
});

router.get(<span class="hljs-string">&apos;/edit/:_id&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
  Model(<span class="hljs-string">&apos;Article&apos;</span>).findOne({_id:req.params._id},<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,article</span>)</span>{
    res.render(<span class="hljs-string">&apos;article/add&apos;</span>,{title:<span class="hljs-string">&apos;&#x7F16;&#x8F91;&#x6587;&#x7AE0;&apos;</span>,article:article});
  });
});
</code></pre>
<h2 id="t8319. &#x641C;&#x7D22;&#x548C;&#x5206;&#x9875;">19. &#x641C;&#x7D22;&#x548C;&#x5206;&#x9875; <a href="#t8319. &#x641C;&#x7D22;&#x548C;&#x5206;&#x9875;"> # </a></h2>
<h3 id="t8419.1 &#x5728;&#x5BFC;&#x822A;&#x680F;&#x589E;&#x52A0;&#x641C;&#x7D22;&#x6846;">19.1 &#x5728;&#x5BFC;&#x822A;&#x680F;&#x589E;&#x52A0;&#x641C;&#x7D22;&#x6846; <a href="#t8419.1 &#x5728;&#x5BFC;&#x822A;&#x680F;&#x589E;&#x52A0;&#x641C;&#x7D22;&#x6846;"> # </a></h3>
<p>views/include/header.ejs</p>
<pre><code class="lang-javascript">&lt;form  <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;navbar-form navbar-right&quot;</span> role=<span class="hljs-string">&quot;search&quot;</span> method=<span class="hljs-string">&quot;get&quot;</span>
action=<span class="hljs-string">&quot;/article/list/1/2&quot;</span>&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-group&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">&quot;keyword&quot;</span>&gt;</span>&#x5173;&#x952E;&#x5B57;<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;text&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;keyword&quot;</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;keyword&quot;</span>
    <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-control&quot;</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">&quot;&lt;%=keyword%&gt;&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;submit&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;btn  btn-default&quot;</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">&quot;search&quot;</span>
   <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;searchBtn&quot;</span>&gt;</span>&#x641C;&#x7D22;<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
</span></code></pre>
<h3 id="t8519.2  &#x5728;&#x9996;&#x9875;&#x589E;&#x52A0;&#x5206;&#x9875;&#x6761;">19.2  &#x5728;&#x9996;&#x9875;&#x589E;&#x52A0;&#x5206;&#x9875;&#x6761; <a href="#t8519.2  &#x5728;&#x9996;&#x9875;&#x589E;&#x52A0;&#x5206;&#x9875;&#x6761;"> # </a></h3>
<p>views/index.ejs</p>
<pre><code class="lang-html"> <span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;pagination&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">%</span>
  <span class="hljs-attribute">for</span>(<span class="hljs-attribute">var</span> <span class="hljs-attribute">i</span>=<span class="hljs-value">1;i&lt;=totalPage;i++){</span>
  %&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/article/list/&lt;%=i%&gt;/&lt;%=pageSize%&gt;?keyword=&lt;%=keyword%&gt;&quot;</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-title">%=i%</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">%</span>
  }
  %&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
</code></pre>
<h3 id="t8619.3 &#x9996;&#x9875;&#x5BFC;&#x822A;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x6587;&#x7AE0;&#x5217;&#x8868;&#x9875;">19.3 &#x9996;&#x9875;&#x5BFC;&#x822A;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x6587;&#x7AE0;&#x5217;&#x8868;&#x9875; <a href="#t8619.3 &#x9996;&#x9875;&#x5BFC;&#x822A;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x6587;&#x7AE0;&#x5217;&#x8868;&#x9875;"> # </a></h3>
<pre><code class="lang-javascript">routes/index.js

router.get(<span class="hljs-string">&apos;/&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>) </span>{
  res.redirect(<span class="hljs-string">&apos;/article/list/1/2&apos;</span>);
});
</code></pre>
<h3 id="t8719.4  &#x589E;&#x52A0;&#x6587;&#x7AE0;&#x5217;&#x8868;&#x5BFC;&#x822A;">19.4  &#x589E;&#x52A0;&#x6587;&#x7AE0;&#x5217;&#x8868;&#x5BFC;&#x822A; <a href="#t8719.4  &#x589E;&#x52A0;&#x6587;&#x7AE0;&#x5217;&#x8868;&#x5BFC;&#x822A;"> # </a></h3>
<p>routes/article.js</p>
<pre><code class="lang-javascript">router.get(<span class="hljs-string">&apos;/list/:pageNum/:pageSize&apos;</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>) </span>{
  <span class="hljs-keyword">var</span> pageNum = req.params.pageNum&amp;&amp;req.params.pageNum&gt;<span class="hljs-number">0</span>?
<span class="hljs-built_in">parseInt</span>(req.params.pageNum):<span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> pageSize =req.params.pageSize&amp;&amp;req.params.pageSize&gt;<span class="hljs-number">0</span>?
<span class="hljs-built_in">parseInt</span>(req.params.pageSize):<span class="hljs-number">2</span>;
  <span class="hljs-keyword">var</span> query = {};
  <span class="hljs-keyword">var</span> searchBtn = req.query.searchBtn;
  <span class="hljs-keyword">var</span> keyword = req.query.keyword;
  <span class="hljs-keyword">if</span>(searchBtn){
    req.session.keyword = keyword;
  }
  <span class="hljs-keyword">if</span>(req.session.keyword){
    query[<span class="hljs-string">&apos;title&apos;</span>] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(req.session.keyword,<span class="hljs-string">&quot;i&quot;</span>);
  }

  Model(<span class="hljs-string">&apos;Article&apos;</span>).count(query,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,count</span>)</span>{
    Model(<span class="hljs-string">&apos;Article&apos;</span>).find(query).sort({createAt:-<span class="hljs-number">1</span>})
      .skip((pageNum-<span class="hljs-number">1</span>)*pageSize)
     .limit(pageSize).populate(<span class="hljs-string">&apos;user&apos;</span>).exec(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,articles</span>)</span>{
         articles.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">article</span>) </span>{
            article.content = markdown.toHTML(article.content);
         });
         res.render(<span class="hljs-string">&apos;index&apos;</span>,{
             title:<span class="hljs-string">&apos;&#x4E3B;&#x9875;&apos;</span>,
             pageNum:pageNum,
             pageSize:pageSize,
             keyword:req.session.keyword,
             totalPage:<span class="hljs-built_in">Math</span>.ceil(count/pageSize),
             articles:articles
         });
       });
  });
});
</code></pre>
<h2 id="t8820. &#x5B9E;&#x73B0;&#x8BC4;&#x8BBA;&#x529F;&#x80FD;">20. &#x5B9E;&#x73B0;&#x8BC4;&#x8BBA;&#x529F;&#x80FD; <a href="#t8820. &#x5B9E;&#x73B0;&#x8BC4;&#x8BBA;&#x529F;&#x80FD;"> # </a></h2>
<h3 id="t8920.1 &#x4FEE;&#x6539;&#x6A21;&#x677F;">20.1 &#x4FEE;&#x6539;&#x6A21;&#x677F; <a href="#t8920.1 &#x4FEE;&#x6539;&#x6A21;&#x677F;"> # </a></h3>
<p>views/article/detail.ejs</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;panel panel-default&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;panel-heading&quot;</span>&gt;</span>
  &#x8BC4;&#x8BBA;&#x5217;&#x8868;
  <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;panel-body&quot;</span>  <span class="hljs-attribute">style</span>=<span class="hljs-value">&quot;height:300px;overflow-y: scroll&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;media-list&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">%</span>
      <span class="hljs-attribute">article.comments.forEach</span>(<span class="hljs-attribute">function</span>(<span class="hljs-attribute">comment</span>){
      %&gt;</span>
         <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;media&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;media-left&quot;</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;#&quot;</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-title">img</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;media-object&quot;</span>
                    <span class="hljs-attribute">src</span>=<span class="hljs-value">&quot;&lt;%=comment.user.avatar%&gt;&quot;</span> <span class="hljs-attribute">alt</span>=<span class="hljs-value">&quot;&quot;</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;media-body&quot;</span>&gt;</span>
               <span class="hljs-tag">&lt;<span class="hljs-title">p</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;media-left&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">%-</span> <span class="hljs-attribute">comment.content</span>%&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;media-bottom&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">%=comment.user.username%</span>&gt;</span>
                 <span class="hljs-tag">&lt;<span class="hljs-title">%=comment.createAt.toLocaleString()%</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
         <span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">%</span>
      });
      %&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;panel panel-default&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">action</span>=<span class="hljs-value">&quot;/article/comment&quot;</span> <span class="hljs-attribute">method</span>=<span class="hljs-value">&quot;post&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;hidden&quot;</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">&quot;&lt;%=article._id%&gt;&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;_id&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;panel-body&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">textarea</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;form-control&quot;</span>   <span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;&quot;</span> <span class="hljs-attribute">cols</span>=<span class="hljs-value">&quot;30&quot;</span> <span class="hljs-attribute">rows</span>=<span class="hljs-value">&quot;10&quot;</span>
       <span class="hljs-attribute">id</span>=<span class="hljs-value">&quot;content&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;content&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;&#x8BF7;&#x8F93;&#x5165;&#x8BC4;&#x8BBA;&quot;</span> &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">textarea</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;panel-footer&quot;</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;submit&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;btn btn-default&quot;</span>&gt;</span>&#x63D0;&#x4EA4;<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<h3 id="t9020.2 &#x4FEE;&#x6539;&#x6A21;&#x578B;">20.2 &#x4FEE;&#x6539;&#x6A21;&#x578B; <a href="#t9020.2 &#x4FEE;&#x6539;&#x6A21;&#x578B;"> # </a></h3>
<p>db/models.js</p>
<pre><code class="lang-javascript"> comments: [{user:{type:ObjectId,ref:<span class="hljs-string">&apos;User&apos;</span>},content:<span class="hljs-built_in">String</span>,
   createAt:{type: <span class="hljs-built_in">Date</span>, <span class="hljs-keyword">default</span>: <span class="hljs-built_in">Date</span>.now}}],
</code></pre>
<h3 id="t9120.3  &#x4FEE;&#x6539;&#x8DEF;&#x7531;">20.3  &#x4FEE;&#x6539;&#x8DEF;&#x7531; <a href="#t9120.3  &#x4FEE;&#x6539;&#x8DEF;&#x7531;"> # </a></h3>
<p>routes/article.js</p>
<pre><code class="lang-javascript">router.post(<span class="hljs-string">&apos;/comment&apos;</span>,middleware.checkLogin, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
   <span class="hljs-keyword">var</span> user = req.session.user;
   Model(<span class="hljs-string">&apos;Article&apos;</span>).update({_id:req.body._id},
     {$push:{comments:{user:user._id,content:req.body.content}}},
     <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,result</span>)</span>{
         <span class="hljs-keyword">if</span>(err){
             req.flash(<span class="hljs-string">&apos;error&apos;</span>,err);
             <span class="hljs-keyword">return</span> res.redirect(<span class="hljs-string">&apos;back&apos;</span>);
          }
         req.flash(<span class="hljs-string">&apos;success&apos;</span>, <span class="hljs-string">&apos;&#x8BC4;&#x8BBA;&#x6210;&#x529F;!&apos;</span>);
        res.redirect(<span class="hljs-string">&apos;back&apos;</span>);
   });
});
</code></pre>
<h2 id="t9221 &#x663E;&#x793A;PV&#x548C;&#x8BC4;&#x8BBA;">21 &#x663E;&#x793A;PV&#x548C;&#x8BC4;&#x8BBA; <a href="#t9221 &#x663E;&#x793A;PV&#x548C;&#x8BC4;&#x8BBA;"> # </a></h2>
<h3 id="t9321.1 &#x5B89;&#x88C5;async">21.1 &#x5B89;&#x88C5;async <a href="#t9321.1 &#x5B89;&#x88C5;async"> # </a></h3>
<pre><code class="lang-javascript">$  npm install <span class="hljs-keyword">async</span> --save
</code></pre>
<h3 id="t9421.2 &#x4FEE;&#x6539;&#x6A21;&#x578B;">21.2 &#x4FEE;&#x6539;&#x6A21;&#x578B; <a href="#t9421.2 &#x4FEE;&#x6539;&#x6A21;&#x578B;"> # </a></h3>
<p>db/models.js</p>
<pre><code class="lang-javascript">pv: {type:<span class="hljs-built_in">Number</span>,<span class="hljs-keyword">default</span>:<span class="hljs-number">0</span>},
</code></pre>
<h3 id="t9521.3 &#x4FEE;&#x6539;&#x8DEF;&#x7531;">21.3 &#x4FEE;&#x6539;&#x8DEF;&#x7531; <a href="#t9521.3 &#x4FEE;&#x6539;&#x8DEF;&#x7531;"> # </a></h3>
<p>routes/article.js</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> <span class="hljs-keyword">async</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;async&apos;</span>);
router.get(<span class="hljs-string">&apos;/detail/:_id&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
    <span class="hljs-keyword">async</span>.parallel([<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback</span>) </span>{
        Model(<span class="hljs-string">&apos;Article&apos;</span>).findOne({_id: req.params._id})
            .populate(<span class="hljs-string">&apos;user&apos;</span>).populate(<span class="hljs-string">&apos;comments.user&apos;</span>)
            .exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, article</span>) </span>{
                article.content = markdown.toHTML(article.content);
                callback(err, article);
            });
    }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback</span>) </span>{
        Model(<span class="hljs-string">&apos;Article&apos;</span>).update({_id: req.params._id}
        ,{$inc: {pv: <span class="hljs-number">1</span>}}, callback);
    }], <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, result</span>) </span>{
        <span class="hljs-keyword">if</span> (err) {
            req.flash(<span class="hljs-string">&apos;error&apos;</span>, err);
            res.redirect(<span class="hljs-string">&apos;back&apos;</span>);
        }
        res.render(<span class="hljs-string">&apos;article/detail&apos;</span>,
       {title: <span class="hljs-string">&apos;&#x67E5;&#x770B;&#x6587;&#x7AE0;&apos;</span>, article: result[<span class="hljs-number">0</span>]});
    });
});
</code></pre>
<h3 id="t9621.4 &#x4FEE;&#x6539;&#x6A21;&#x677F;">21.4 &#x4FEE;&#x6539;&#x6A21;&#x677F; <a href="#t9621.4 &#x4FEE;&#x6539;&#x6A21;&#x677F;"> # </a></h3>
<p>views/index.ejs</p>
<pre><code class="lang-html">&#x9605;&#x8BFB;&#xFF1A;<span class="hljs-tag">&lt;<span class="hljs-title">%=</span> <span class="hljs-attribute">article.pv</span> %&gt;</span>|
&#x8BC4;&#x8BBA;&#xFF1A;<span class="hljs-tag">&lt;<span class="hljs-title">%=</span> <span class="hljs-attribute">article.comments.length</span>%&gt;</span>
</code></pre>
<h2 id="t9722. &#x7F8E;&#x5316;404&#x4E2D;&#x95F4;&#x4EF6;">22. &#x7F8E;&#x5316;404&#x4E2D;&#x95F4;&#x4EF6; <a href="#t9722. &#x7F8E;&#x5316;404&#x4E2D;&#x95F4;&#x4EF6;"> # </a></h2>
<h3 id="t9822.1 &#x4FEE;&#x6539;404&#x4E2D;&#x95F4;&#x4EF6;">22.1 &#x4FEE;&#x6539;404&#x4E2D;&#x95F4;&#x4EF6; <a href="#t9822.1 &#x4FEE;&#x6539;404&#x4E2D;&#x95F4;&#x4EF6;"> # </a></h3>
<p>app.js</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// catch 404 and forward to error handler</span>
app.use(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>) </span>{
  res.render(<span class="hljs-string">&quot;404&quot;</span>);
});
</code></pre>
<h3 id="t9922.2 &#x589E;&#x52A0;404&#x9875;&#x9762;&#x6A21;&#x677F;">22.2 &#x589E;&#x52A0;404&#x9875;&#x9762;&#x6A21;&#x677F; <a href="#t9922.2 &#x589E;&#x52A0;404&#x9875;&#x9762;&#x6A21;&#x677F;"> # </a></h3>
<p>views/404.ejs</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">%</span> <span class="hljs-attribute">include</span> <span class="hljs-attribute">include</span>/<span class="hljs-attribute">header.ejs</span>%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">&quot;container&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">img</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">&quot;&quot;</span> <span class="hljs-attribute">alt</span>=<span class="hljs-value">&quot;404&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">%</span> <span class="hljs-attribute">include</span> <span class="hljs-attribute">include</span>/<span class="hljs-attribute">footer.ejs</span>%&gt;</span>
</code></pre>
<h2 id="t10023 &#x6253;&#x5370;&#x65E5;&#x5FD7;">23 &#x6253;&#x5370;&#x65E5;&#x5FD7; <a href="#t10023 &#x6253;&#x5370;&#x65E5;&#x5FD7;"> # </a></h2>
<p>&#x73B0;&#x5728;&#x7ED9;&#x535A;&#x5BA2;&#x589E;&#x52A0;&#x65E5;&#x5FD7;&#xFF0C;&#x5B9E;&#x73B0;&#x8BBF;&#x95EE;&#x65E5;&#x5FD7;&#xFF08;access.log&#xFF09;&#x548C;&#x9519;&#x8BEF;&#x65E5;&#x5FD7;&#xFF08;error.log&#xFF09;&#x529F;&#x80FD;
&#x628A;&#x65E5;&#x5FD7;&#x4FDD;&#x5B58;&#x4E3A;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;
app.js</p>
<pre><code class="lang-javascript"><span class="hljs-comment">//&#x6B63;&#x5E38;&#x65E5;&#x5FD7;</span>
<span class="hljs-keyword">var</span> accessLog = fs.createWriteStream(<span class="hljs-string">&apos;access.log&apos;</span>, {flags: <span class="hljs-string">&apos;a&apos;</span>});
app.use(logger(<span class="hljs-string">&apos;dev&apos;</span>,{stream: accessLog}));

<span class="hljs-comment">//&#x9519;&#x8BEF;&#x65E5;&#x5FD7;</span>
<span class="hljs-keyword">var</span> errorLog = fs.createWriteStream(<span class="hljs-string">&apos;error.log&apos;</span>, {flags: <span class="hljs-string">&apos;a&apos;</span>});
app.use(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, req, res, next</span>) </span>{
  <span class="hljs-keyword">var</span> meta = <span class="hljs-string">&apos;[&apos;</span> + <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() + <span class="hljs-string">&apos;] &apos;</span> + req.url + <span class="hljs-string">&apos;\n&apos;</span>;
  errorLog.write(meta + err.stack + <span class="hljs-string">&apos;\n&apos;</span>);
  next();
});
</code></pre>
<h2 id="t10124 &#x53D1;&#x5E03;heroKu">24 &#x53D1;&#x5E03;heroKu <a href="#t10124 &#x53D1;&#x5E03;heroKu"> # </a></h2>
<p><a href="https://www.heroku.com/">https://www.heroku.com/</a></p>
<h3 id="t10224.1 &#x6CE8;&#x518C;">24.1 &#x6CE8;&#x518C; <a href="#t10224.1 &#x6CE8;&#x518C;"> # </a></h3>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/heroku1.jpg" class="img-responsive"></p>
<h3 id="t10324.2 &#x9A8C;&#x8BC1;&#x90AE;&#x7BB1;">24.2 &#x9A8C;&#x8BC1;&#x90AE;&#x7BB1; <a href="#t10324.2 &#x9A8C;&#x8BC1;&#x90AE;&#x7BB1;"> # </a></h3>
<p>&#x53EF;&#x7528;qq,&#x4E0D;&#x80FD;126 163&#x7B49;
<img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/hero2.jpg" class="img-responsive"></p>
<h3 id="t10424.3 &#x67E5;&#x770B;&#x90AE;&#x7BB1;&#x70B9;&#x51FB;&#x6FC0;&#x6D3B;&#x94FE;&#x63A5;">24.3 &#x67E5;&#x770B;&#x90AE;&#x7BB1;&#x70B9;&#x51FB;&#x6FC0;&#x6D3B;&#x94FE;&#x63A5; <a href="#t10424.3 &#x67E5;&#x770B;&#x90AE;&#x7BB1;&#x70B9;&#x51FB;&#x6FC0;&#x6D3B;&#x94FE;&#x63A5;"> # </a></h3>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/heroku3.png" class="img-responsive"></p>
<h3 id="t10524.4 &#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x5BC6;&#x7801;">24.4 &#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x5BC6;&#x7801; <a href="#t10524.4 &#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x5BC6;&#x7801;"> # </a></h3>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/heroku4.png" class="img-responsive"></p>
<h3 id="t10624.5 &#x9A8C;&#x8BC1;&#x6210;&#x529F;">24.5 &#x9A8C;&#x8BC1;&#x6210;&#x529F; <a href="#t10624.5 &#x9A8C;&#x8BC1;&#x6210;&#x529F;"> # </a></h3>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/heroku6.png" class="img-responsive"></p>
<h3 id="t10724.6 &#x8FDB;&#x5165;&#x63A7;&#x5236;&#x9762;&#x677F;">24.6 &#x8FDB;&#x5165;&#x63A7;&#x5236;&#x9762;&#x677F; <a href="#t10724.6 &#x8FDB;&#x5165;&#x63A7;&#x5236;&#x9762;&#x677F;"> # </a></h3>
<p>&#x70B9;&#x51FB;&#x53F3;&#x4E0A;&#x89D2;&#x7684;&#x521B;&#x5EFA;app&#x6309;&#x94AE;</p>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/hero7.png" class="img-responsive"></p>
<h3 id="t10824.7 &#x8F93;&#x5165;app&#x540D;&#x79F0;">24.7 &#x8F93;&#x5165;app&#x540D;&#x79F0; <a href="#t10824.7 &#x8F93;&#x5165;app&#x540D;&#x79F0;"> # </a></h3>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/hero8.png" class="img-responsive"></p>
<h3 id="t10924.8 &#x5C06;&#x6B64;APP&#x5173;&#x8054;&#x5230;github&#x4E0A;">24.8 &#x5C06;&#x6B64;APP&#x5173;&#x8054;&#x5230;github&#x4E0A; <a href="#t10924.8 &#x5C06;&#x6B64;APP&#x5173;&#x8054;&#x5230;github&#x4E0A;"> # </a></h3>
<p>&#x8981;&#x6388;&#x6743;github&#x767B;&#x9646;</p>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/hero9.png" class="img-responsive"></p>
<h3 id="t11024.9 &#x70B9;&#x51FB;&#x5E03;&#x7F72;&#x5206;&#x652F;">24.9 &#x70B9;&#x51FB;&#x5E03;&#x7F72;&#x5206;&#x652F; <a href="#t11024.9 &#x70B9;&#x51FB;&#x5E03;&#x7F72;&#x5206;&#x652F;"> # </a></h3>
<p><img src="http://7xjf2l.com2.z0.glb.qiniucdn.com/heru10.png" class="img-responsive"></p>
<h3 id="t11124.10 &#x53D1;&#x5E03;&#x7ED3;&#x679C;">24.10 &#x53D1;&#x5E03;&#x7ED3;&#x679C; <a href="#t11124.10 &#x53D1;&#x5E03;&#x7ED3;&#x679C;"> # </a></h3>
<p><a href="https://zhufengpeixunblog.herokuapp.com">&#x6F14;&#x793A;&#x5730;&#x5740;</a>
<a href="https://github.com/zhufengnodejs/zhufengpeixunblog">&#x9879;&#x76EE;&#x6E90;&#x7801;</a></p>


        </div>
    
</div>
<style>
    .page-toc{
        overflow: hidden;
        position:fixed;
        left:50%;
        margin-left:250px;
	width:350px
    }
    .page-toc > ul li{
        list-style-position: inside;
	line-height:120%
    }
    .page-toc > ul{
        transition: all 0.2s;
        position: relative;
    }
    .page-toc > ul a {
	color:#009a61;
	font-size:110% ! important;
	line-height:120%
    }
    .page-toc > ul .red{
        background: #f3f3f3;
        z-index: 1;
        border-left: 3px solid #009a61;
        -webkit-transition: all .2s ease;
        transition: all .2s ease;
	color:#000
    }

    .markdown-body{
	font-size: 120% ! important;
        max-width:800px;
    }
    .container{
       font-size: 110% ! important;
    }
    html,body,.container{
      font-family: Helvetica Neue,Helvetica,Arial,PingFang SC,Hiragino Sans GB,WenQuanYi Micro Hei,Microsoft Yahei,sans-serif ! important;
    }
    /*url("/static/img/banner.jpg") no-repeat*/
    .bs-docs-header{
        background:linear-gradient(to right ,#333333 50%,#0d0b0c 50%) ;
        padding: 0;
    }
    .new-back{
        background-image: url("static/img/banner.jpg") ;
        background-repeat: no-repeat;
        background-position: center center;
        padding: 88px;
    }
    .markdown-body pre code,.markdown-body code{
        font-size: 20px;
        line-height: 24px;
    }
    .markdown-body code{
      line-height: inherit;
    }
    .markdown-body h3{
        font-size:1.4em;
    }
    .markdown-body h4{
        font-size:1em;
    }



    /*index*/
    .jw-style{
        font-size: 1.75em;
        color: #1d3e81;
        line-height: 2em;
    }

    .understand-me {
        text-align: center;
        margin: 100px auto 0;
    }

    .understand-me li {
        vertical-align: top;
        width: 33.3333%;
        display: inline-block;
        *display: inline;
        *zoom: 1;
        text-align: center;
    }

    .understand-me li span {
        color: #1a1a1a;
        font-size: 1.6em;

    }

    .understand-me p {
        margin: 0 auto;
        width: 90%;
        text-align: left;
        color: #4c4c4c;
        font-size: 1em;
        line-height: 1.2em;
    }

    .understand-me img {
        -webkit-transition: all 0.4s;
        -moz-transition: all 0.4s;
        -ms-transition: all 0.4s;
        -o-transition: all 0.4s;
        transition: all 0.4s;
    }
    .footers{
        background:#0a0a0a url('static/img/footer.jpg') no-repeat center center;height: 248px; margin-top: 40px
    }
    .understand-me img:hover {
        -webkit-transform: rotate(-90deg);
        -moz-transform: rotate(-90deg);
        -ms-transform: rotate(-90deg);
        -o-transform: rotate(-90deg);
        transform: rotate(-90deg);
    }
    @media screen and (max-width: 479px) {
        .understand-me li{
            width: 100%;
            margin-bottom: 2em;
        }
        .new-back{
            padding: 28px;
        }
        .understand-me p {
            width: 60%;
        }
        .footers{
            height: 80px;
            background-size:auto 100%;;
        }
    }

</style>
<script src="https://cdn.bootcss.com/jquery/3.0.0/jquery.js"></script>
<script>
if(!$('.understand-me').length){
var bar = $(window).height() - $('.navbar ').height() - $('.page-toc').position().top;
var count =  bar/26/2;
var barHeight = $('.page-toc').outerHeight();
$('.page-toc li').eq(0).children('a').addClass('red');
var arr = [];
$("h1,h2,h3,h4,h5,h6").each(function () {
    arr.push($(this).position().top);
});
if(!($(window).height()-50 > barHeight)){
    var flagTop = true;
}
function dark(){
    var top =  Math.abs($('.page-toc > ul').position().top);
    var cur = $(document).scrollTop();
    for(var i = arr.length; i >=0;i--){
        if(arr[i]<=cur){
            break;
        }
    }
    if(i===-1){
        i = 0;
    }
    $('.page-toc li a').removeClass('red');
    $('.page-toc li').eq(i).children('a').addClass('red');
    if(flagTop){
      if(i> arr.length-count){
          $(' .page-toc > ul').css('top',-(barHeight-bar));
          return;
      }
      if(i>count){
          $(' .page-toc > ul').css('top',-26*(i-count));
      }else{
          $(' .page-toc > ul').css('top',0);
      }
    }
}
$(window).on('scroll',dark);
}
</script>

</body>
</html>


<script>

</script>